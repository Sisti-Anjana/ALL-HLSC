{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LibsysAdmin\\\\OneDrive - Libsys IT Services Private Limited\\\\Desktop\\\\ALLLL HLSC\\\\client\\\\src\\\\context\\\\AuthContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(undefined);\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  // Initialize user from localStorage if token exists\n  const [user, setUser] = useState(() => {\n    try {\n      const storedUser = localStorage.getItem('user');\n      const token = localStorage.getItem('auth_token');\n      if (storedUser && token) {\n        return JSON.parse(storedUser);\n      }\n    } catch (error) {\n      console.error('Error parsing stored user:', error);\n    }\n    return null;\n  });\n  const [loading, setLoading] = useState(false);\n  const login = async credentials => {\n    setLoading(true);\n    try {\n      const {\n        authService\n      } = await import('../services/authService');\n      const response = await authService.login(credentials);\n      localStorage.setItem('auth_token', response.token);\n      localStorage.setItem('user', JSON.stringify(response.user));\n      setUser(response.user);\n    } catch (error) {\n      var _error$response, _error$response$data, _error$response2, _error$response3;\n      console.error('Login error:', error);\n      const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message || 'Login failed';\n      const errorDetails = (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data;\n      console.error('Error details:', {\n        message: errorMessage,\n        response: errorDetails,\n        status: (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status\n      });\n      // Show user-friendly error message\n      const userMessage = errorMessage.includes('Invalid email or password') ? 'Invalid email or password. Please check your credentials.' : errorMessage.includes('Database error') ? 'Database connection error. Please check server configuration.' : errorMessage.includes('email') ? 'Please enter a valid email address.' : errorMessage.includes('password') ? 'Password is required.' : errorMessage;\n      // Use toast instead of alert for better UX\n      const {\n        default: toast\n      } = await import('react-hot-toast');\n      toast.error(userMessage);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem('auth_token');\n    localStorage.removeItem('user');\n    setUser(null);\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      login,\n      logout,\n      isAuthenticated: !!user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"9weQ4zIoOgWZ9BCYcA+nZajKPIc=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","jsxDEV","_jsxDEV","AuthContext","undefined","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","storedUser","localStorage","getItem","token","JSON","parse","error","console","loading","setLoading","login","credentials","authService","response","setItem","stringify","_error$response","_error$response$data","_error$response2","_error$response3","errorMessage","data","message","errorDetails","status","userMessage","includes","default","toast","logout","removeItem","Provider","value","isAuthenticated","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/LibsysAdmin/OneDrive - Libsys IT Services Private Limited/Desktop/ALLLL HLSC/client/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, ReactNode } from 'react'\n\ninterface AuthContextType {\n  user: any | null\n  loading: boolean\n  login: (credentials: any) => Promise<void>\n  logout: () => void\n  isAuthenticated: boolean\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider')\n  }\n  return context\n}\n\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  // Initialize user from localStorage if token exists\n  const [user, setUser] = useState<any | null>(() => {\n    try {\n      const storedUser = localStorage.getItem('user')\n      const token = localStorage.getItem('auth_token')\n      if (storedUser && token) {\n        return JSON.parse(storedUser)\n      }\n    } catch (error) {\n      console.error('Error parsing stored user:', error)\n    }\n    return null\n  })\n  const [loading, setLoading] = useState(false)\n\n  const login = async (credentials: any) => {\n    setLoading(true)\n    try {\n      const { authService } = await import('../services/authService')\n      const response = await authService.login(credentials)\n      localStorage.setItem('auth_token', response.token)\n      localStorage.setItem('user', JSON.stringify(response.user))\n      setUser(response.user)\n    } catch (error: any) {\n      console.error('Login error:', error)\n      const errorMessage = error.response?.data?.error || error.message || 'Login failed'\n      const errorDetails = error.response?.data\n      console.error('Error details:', {\n        message: errorMessage,\n        response: errorDetails,\n        status: error.response?.status,\n      })\n      // Show user-friendly error message\n      const userMessage = errorMessage.includes('Invalid email or password') \n        ? 'Invalid email or password. Please check your credentials.'\n        : errorMessage.includes('Database error')\n        ? 'Database connection error. Please check server configuration.'\n        : errorMessage.includes('email')\n        ? 'Please enter a valid email address.'\n        : errorMessage.includes('password')\n        ? 'Password is required.'\n        : errorMessage\n      // Use toast instead of alert for better UX\n      const { default: toast } = await import('react-hot-toast')\n      toast.error(userMessage)\n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('auth_token')\n    localStorage.removeItem('user')\n    setUser(null)\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        loading,\n        login,\n        logout,\n        isAuthenticated: !!user,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}