{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LibsysAdmin\\\\OneDrive - Libsys IT Services Private Limited\\\\Desktop\\\\ALLLL HLSC\\\\client\\\\src\\\\context\\\\AuthContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState } from 'react';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(undefined);\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  // Initialize user from localStorage if token exists\n  const [user, setUser] = useState(() => {\n    try {\n      const storedUser = localStorage.getItem('user');\n      const token = localStorage.getItem('auth_token');\n      if (storedUser && token) {\n        return JSON.parse(storedUser);\n      }\n    } catch (error) {\n      console.error('Error parsing stored user:', error);\n    }\n    return null;\n  });\n  const [loading, setLoading] = useState(false);\n  const login = async credentials => {\n    setLoading(true);\n    console.log('ðŸ” AuthContext - Starting login process...');\n    try {\n      const {\n        authService\n      } = await import('../services/authService');\n      console.log('ðŸ” AuthContext - Calling authService.login...');\n      const response = await authService.login(credentials);\n      console.log('âœ… AuthContext - Login successful, saving to localStorage');\n      localStorage.setItem('auth_token', response.token);\n      localStorage.setItem('user', JSON.stringify(response.user));\n      setUser(response.user);\n      console.log('âœ… AuthContext - User state updated');\n    } catch (error) {\n      var _error$response, _error$response2, _error$response4, _error$response4$data;\n      console.error('âŒ AuthContext - Login error:', error);\n      console.error('âŒ Error type:', error.constructor.name);\n      console.error('âŒ Error code:', error.code);\n      console.error('âŒ Error message:', error.message);\n      console.error('âŒ Error response:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n      console.error('âŒ Error status:', (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status);\n\n      // Determine user-friendly error message\n      let errorMessage = 'Login failed';\n      if (error.message) {\n        var _error$response3, _error$response3$data;\n        if (error.message.includes('timeout')) {\n          errorMessage = 'Request timeout. The server is taking too long to respond. Please check if the server is running.';\n        } else if (error.message.includes('Network error') || error.message.includes('Cannot connect')) {\n          errorMessage = 'Cannot connect to server. Please check if the server is running and try again.';\n        } else if ((_error$response3 = error.response) !== null && _error$response3 !== void 0 && (_error$response3$data = _error$response3.data) !== null && _error$response3$data !== void 0 && _error$response3$data.error) {\n          errorMessage = error.response.data.error;\n        } else {\n          errorMessage = error.message;\n        }\n      } else if ((_error$response4 = error.response) !== null && _error$response4 !== void 0 && (_error$response4$data = _error$response4.data) !== null && _error$response4$data !== void 0 && _error$response4$data.error) {\n        errorMessage = error.response.data.error;\n      }\n\n      // Show user-friendly error message\n      const userMessage = errorMessage.includes('Invalid email or password') ? 'Invalid email or password. Please check your credentials.' : errorMessage.includes('Database error') ? 'Database connection error. Please check server configuration.' : errorMessage.includes('timeout') ? 'Server timeout. Please check if the server is running.' : errorMessage.includes('Network error') || errorMessage.includes('Cannot connect') ? 'Cannot connect to server. Please check if the server is running.' : errorMessage.includes('email') ? 'Please enter a valid email address.' : errorMessage.includes('password') ? 'Password is required.' : errorMessage;\n\n      // Use toast instead of alert for better UX\n      toast.error(userMessage);\n      throw error;\n    } finally {\n      setLoading(false);\n      console.log('ðŸ” AuthContext - Login process completed (loading set to false)');\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem('auth_token');\n    localStorage.removeItem('user');\n    setUser(null);\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      login,\n      logout,\n      isAuthenticated: !!user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"9weQ4zIoOgWZ9BCYcA+nZajKPIc=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","toast","jsxDEV","_jsxDEV","AuthContext","undefined","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","storedUser","localStorage","getItem","token","JSON","parse","error","console","loading","setLoading","login","credentials","log","authService","response","setItem","stringify","_error$response","_error$response2","_error$response4","_error$response4$data","constructor","name","code","message","data","status","errorMessage","_error$response3","_error$response3$data","includes","userMessage","logout","removeItem","Provider","value","isAuthenticated","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/LibsysAdmin/OneDrive - Libsys IT Services Private Limited/Desktop/ALLLL HLSC/client/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, ReactNode } from 'react'\nimport toast from 'react-hot-toast'\n\ninterface AuthContextType {\n  user: any | null\n  loading: boolean\n  login: (credentials: any) => Promise<void>\n  logout: () => void\n  isAuthenticated: boolean\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider')\n  }\n  return context\n}\n\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  // Initialize user from localStorage if token exists\n  const [user, setUser] = useState<any | null>(() => {\n    try {\n      const storedUser = localStorage.getItem('user')\n      const token = localStorage.getItem('auth_token')\n      if (storedUser && token) {\n        return JSON.parse(storedUser)\n      }\n    } catch (error) {\n      console.error('Error parsing stored user:', error)\n    }\n    return null\n  })\n  const [loading, setLoading] = useState(false)\n\n  const login = async (credentials: any) => {\n    setLoading(true)\n    console.log('ðŸ” AuthContext - Starting login process...')\n    try {\n      const { authService } = await import('../services/authService')\n      console.log('ðŸ” AuthContext - Calling authService.login...')\n      const response = await authService.login(credentials)\n      console.log('âœ… AuthContext - Login successful, saving to localStorage')\n      localStorage.setItem('auth_token', response.token)\n      localStorage.setItem('user', JSON.stringify(response.user))\n      setUser(response.user)\n      console.log('âœ… AuthContext - User state updated')\n    } catch (error: any) {\n      console.error('âŒ AuthContext - Login error:', error)\n      console.error('âŒ Error type:', error.constructor.name)\n      console.error('âŒ Error code:', error.code)\n      console.error('âŒ Error message:', error.message)\n      console.error('âŒ Error response:', error.response?.data)\n      console.error('âŒ Error status:', error.response?.status)\n      \n      // Determine user-friendly error message\n      let errorMessage = 'Login failed'\n      \n      if (error.message) {\n        if (error.message.includes('timeout')) {\n          errorMessage = 'Request timeout. The server is taking too long to respond. Please check if the server is running.'\n        } else if (error.message.includes('Network error') || error.message.includes('Cannot connect')) {\n          errorMessage = 'Cannot connect to server. Please check if the server is running and try again.'\n        } else if (error.response?.data?.error) {\n          errorMessage = error.response.data.error\n        } else {\n          errorMessage = error.message\n        }\n      } else if (error.response?.data?.error) {\n        errorMessage = error.response.data.error\n      }\n      \n      // Show user-friendly error message\n      const userMessage = errorMessage.includes('Invalid email or password') \n        ? 'Invalid email or password. Please check your credentials.'\n        : errorMessage.includes('Database error')\n        ? 'Database connection error. Please check server configuration.'\n        : errorMessage.includes('timeout')\n        ? 'Server timeout. Please check if the server is running.'\n        : errorMessage.includes('Network error') || errorMessage.includes('Cannot connect')\n        ? 'Cannot connect to server. Please check if the server is running.'\n        : errorMessage.includes('email')\n        ? 'Please enter a valid email address.'\n        : errorMessage.includes('password')\n        ? 'Password is required.'\n        : errorMessage\n      \n      // Use toast instead of alert for better UX\n      toast.error(userMessage)\n      throw error\n    } finally {\n      setLoading(false)\n      console.log('ðŸ” AuthContext - Login process completed (loading set to false)')\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('auth_token')\n    localStorage.removeItem('user')\n    setUser(null)\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        loading,\n        login,\n        logout,\n        isAuthenticated: !!user,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}