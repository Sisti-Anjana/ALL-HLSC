{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LibsysAdmin\\\\OneDrive - Libsys IT Services Private Limited\\\\Desktop\\\\ALLLL HLSC\\\\client\\\\src\\\\components\\\\analytics\\\\CoverageMatrix.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Bar } from 'react-chartjs-2';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\nimport { issueService } from '../../services/issueService';\nimport { adminService } from '../../services/adminService';\nimport { useAuth } from '../../context/AuthContext';\nimport Card from '../common/Card';\nimport Button from '../common/Button';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\nconst getCellToneClass = (count, max) => {\n  if (!count || max === 0) {\n    return 'bg-gray-50 border border-gray-100 text-gray-400';\n  }\n  const ratio = count / max;\n  if (ratio >= 0.8) {\n    return 'bg-green-600 text-white';\n  }\n  if (ratio >= 0.6) {\n    return 'bg-green-500 text-white';\n  }\n  if (ratio >= 0.4) {\n    return 'bg-green-400 text-white';\n  }\n  if (ratio >= 0.2) {\n    return 'bg-green-200 text-green-900';\n  }\n  return 'bg-green-100 text-green-800';\n};\nconst CoverageMatrix = () => {\n  _s();\n  var _matrixData$find;\n  const {\n    user: currentUser\n  } = useAuth();\n  const [userSearch, setUserSearch] = useState('');\n  const [hourFilter, setHourFilter] = useState('all');\n  const [issueFilter, setIssueFilter] = useState('all');\n  const [dateRange, setDateRange] = useState('today');\n  const [customStartDate, setCustomStartDate] = useState('');\n  const [customEndDate, setCustomEndDate] = useState('');\n  const [hoveredCell, setHoveredCell] = useState(null);\n\n  // Fetch users\n  const {\n    data: users = []\n  } = useQuery({\n    queryKey: ['admin-users'],\n    queryFn: adminService.getUsers\n  });\n\n  // Fetch issues\n  const {\n    data: allIssues = []\n  } = useQuery({\n    queryKey: ['issues'],\n    queryFn: () => issueService.getAll({})\n  });\n\n  // Filter issues based on date range and issue filter\n  const filteredIssues = useMemo(() => {\n    let filtered = allIssues;\n\n    // Date range filter\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    if (dateRange === 'today') {\n      filtered = filtered.filter(issue => {\n        const issueDate = new Date(issue.created_at);\n        issueDate.setHours(0, 0, 0, 0);\n        return issueDate.getTime() === today.getTime();\n      });\n    } else if (dateRange === 'yesterday') {\n      const yesterday = new Date(today);\n      yesterday.setDate(yesterday.getDate() - 1);\n      filtered = filtered.filter(issue => {\n        const issueDate = new Date(issue.created_at);\n        issueDate.setHours(0, 0, 0, 0);\n        return issueDate.getTime() === yesterday.getTime();\n      });\n    } else if (dateRange === 'week') {\n      const weekAgo = new Date(today);\n      weekAgo.setDate(today.getDate() - 7);\n      filtered = filtered.filter(issue => {\n        const issueDate = new Date(issue.created_at);\n        return issueDate >= weekAgo;\n      });\n    } else if (dateRange === 'month') {\n      const monthAgo = new Date(today);\n      monthAgo.setMonth(today.getMonth() - 1);\n      filtered = filtered.filter(issue => {\n        const issueDate = new Date(issue.created_at);\n        return issueDate >= monthAgo;\n      });\n    } else if (dateRange === 'custom' && customStartDate && customEndDate) {\n      const start = new Date(customStartDate);\n      const end = new Date(customEndDate);\n      end.setHours(23, 59, 59, 999);\n      filtered = filtered.filter(issue => {\n        const issueDate = new Date(issue.created_at);\n        return issueDate >= start && issueDate <= end;\n      });\n    }\n\n    // Issue filter\n    if (issueFilter === 'active') {\n      filtered = filtered.filter(issue => issue.description && issue.description.toLowerCase() !== 'no issue');\n    }\n\n    // Hour filter\n    if (hourFilter !== 'all') {\n      const hour = parseInt(hourFilter);\n      filtered = filtered.filter(issue => issue.issue_hour === hour);\n    }\n    return filtered;\n  }, [allIssues, dateRange, customStartDate, customEndDate, issueFilter, hourFilter]);\n\n  // Build matrix data\n  const matrixData = useMemo(() => {\n    const userMap = {};\n    filteredIssues.forEach(issue => {\n      var _issue$monitored_by;\n      const monitoredBy = ((_issue$monitored_by = issue.monitored_by) === null || _issue$monitored_by === void 0 ? void 0 : _issue$monitored_by[0]) || 'Unknown';\n      const username = monitoredBy.split('@')[0];\n      const displayName = username || 'Unknown';\n      if (!userMap[monitoredBy]) {\n        userMap[monitoredBy] = {\n          userName: monitoredBy,\n          displayName,\n          hours: {}\n        };\n      }\n      const hour = issue.issue_hour;\n      if (!userMap[monitoredBy].hours[hour]) {\n        userMap[monitoredBy].hours[hour] = [];\n      }\n      userMap[monitoredBy].hours[hour].push(issue);\n    });\n\n    // Filter by user search\n    const filteredUsers = Object.values(userMap).filter(user => user.displayName.toLowerCase().includes(userSearch.toLowerCase()) || user.userName.toLowerCase().includes(userSearch.toLowerCase()));\n    return filteredUsers;\n  }, [filteredIssues, userSearch]);\n\n  // Calculate max count for color coding\n  const maxCount = useMemo(() => {\n    let max = 0;\n    matrixData.forEach(user => {\n      Object.values(user.hours).forEach(issues => {\n        max = Math.max(max, issues.length);\n      });\n    });\n    return max;\n  }, [matrixData]);\n\n  // Get cell info for tooltip\n  const getCellInfo = (userId, hour) => {\n    const user = matrixData.find(u => u.userName === userId);\n    if (!user) return null;\n    const issues = user.hours[hour] || [];\n    const portfolios = new Set(issues.map(i => i.portfolio_id));\n    const issuesYes = issues.filter(i => i.description && i.description.toLowerCase() !== 'no issue');\n    const portfolioInstances = Array.from(portfolios).map(portfolioId => {\n      var _portfolioIssues$, _portfolioIssues$$por, _portfolioIssues$2, _portfolioIssues$2$no, _portfolioIssues$2$no2;\n      const portfolioIssues = issues.filter(i => i.portfolio_id === portfolioId);\n      const portfolioName = ((_portfolioIssues$ = portfolioIssues[0]) === null || _portfolioIssues$ === void 0 ? void 0 : (_portfolioIssues$$por = _portfolioIssues$.portfolio) === null || _portfolioIssues$$por === void 0 ? void 0 : _portfolioIssues$$por.name) || 'Unknown';\n      const caseNumber = ((_portfolioIssues$2 = portfolioIssues[0]) === null || _portfolioIssues$2 === void 0 ? void 0 : (_portfolioIssues$2$no = _portfolioIssues$2.notes) === null || _portfolioIssues$2$no === void 0 ? void 0 : (_portfolioIssues$2$no2 = _portfolioIssues$2$no.match(/Case #:\\s*(.+)/)) === null || _portfolioIssues$2$no2 === void 0 ? void 0 : _portfolioIssues$2$no2[1]) || 'N/A';\n      return {\n        portfolio: portfolioName,\n        caseNumber\n      };\n    });\n    return {\n      totalIssuesCount: issues.length,\n      totalCount: portfolios.size,\n      portfolios: Array.from(portfolios).map(id => {\n        var _issue$portfolio;\n        const issue = issues.find(i => i.portfolio_id === id);\n        return (issue === null || issue === void 0 ? void 0 : (_issue$portfolio = issue.portfolio) === null || _issue$portfolio === void 0 ? void 0 : _issue$portfolio.name) || 'Unknown';\n      }),\n      portfolioInstances,\n      issuesYes: issuesYes.map(issue => {\n        var _issue$portfolio2, _issue$notes, _issue$notes$match;\n        return {\n          portfolio: ((_issue$portfolio2 = issue.portfolio) === null || _issue$portfolio2 === void 0 ? void 0 : _issue$portfolio2.name) || 'Unknown',\n          details: issue.description || '',\n          caseNumber: ((_issue$notes = issue.notes) === null || _issue$notes === void 0 ? void 0 : (_issue$notes$match = _issue$notes.match(/Case #:\\s*(.+)/)) === null || _issue$notes$match === void 0 ? void 0 : _issue$notes$match[1]) || 'N/A',\n          date: new Date(issue.created_at).toLocaleString()\n        };\n      })\n    };\n  };\n  const handleCellMouseEnter = (e, userId, hour) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const spaceAbove = rect.top;\n    const spaceBelow = viewportHeight - rect.bottom;\n    const showAbove = spaceAbove > spaceBelow;\n    setHoveredCell({\n      userId,\n      hour,\n      position: {\n        top: showAbove ? rect.top - 10 : rect.bottom + 10,\n        left: rect.left + rect.width / 2,\n        showAbove\n      }\n    });\n  };\n  const handleCellMouseLeave = () => {\n    setHoveredCell(null);\n  };\n  const handleResetFilters = () => {\n    setUserSearch('');\n    setHourFilter('all');\n    setIssueFilter('all');\n    setDateRange('today');\n    setCustomStartDate('');\n    setCustomEndDate('');\n  };\n  const handleExportCSV = () => {\n    const csvRows = [['User', ...Array.from({\n      length: 24\n    }, (_, i) => `${i}`), 'Total'], ...matrixData.map(user => {\n      const row = [user.displayName];\n      let total = 0;\n      for (let hour = 0; hour < 24; hour++) {\n        var _user$hours$hour;\n        const count = ((_user$hours$hour = user.hours[hour]) === null || _user$hours$hour === void 0 ? void 0 : _user$hours$hour.length) || 0;\n        row.push(count.toString());\n        total += count;\n      }\n      row.push(total.toString());\n      return row;\n    }), ['Total', ...Array.from({\n      length: 24\n    }, (_, hour) => {\n      const count = matrixData.reduce((sum, user) => {\n        var _user$hours$hour2;\n        return sum + (((_user$hours$hour2 = user.hours[hour]) === null || _user$hours$hour2 === void 0 ? void 0 : _user$hours$hour2.length) || 0);\n      }, 0);\n      return count.toString();\n    }), matrixData.reduce((sum, user) => {\n      return sum + Object.values(user.hours).reduce((s, issues) => s + issues.length, 0);\n    }, 0).toString()]];\n    const csvContent = csvRows.map(row => row.join(',')).join('\\n');\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `user_hour_coverage_matrix_${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    toast.success('Coverage matrix exported successfully');\n  };\n\n  // Calculate user coverage for chart\n  const userCoverageData = useMemo(() => {\n    return matrixData.map(user => {\n      const totalPortfolios = new Set(Object.values(user.hours).flatMap(issues => issues.map(i => i.portfolio_id))).size;\n      return {\n        userName: user.displayName,\n        totalPortfolios\n      };\n    }).sort((a, b) => b.totalPortfolios - a.totalPortfolios).slice(0, 10);\n  }, [matrixData]);\n  const chartData = {\n    labels: userCoverageData.map(u => u.userName.length > 20 ? u.userName.substring(0, 20) + '...' : u.userName),\n    datasets: [{\n      label: 'Total Portfolios Monitored',\n      data: userCoverageData.map(u => u.totalPortfolios),\n      backgroundColor: userCoverageData.map((_, idx) => idx < 3 ? 'rgba(34, 197, 94, 0.8)' : 'rgba(34, 197, 94, 0.4)'),\n      borderColor: userCoverageData.map((_, idx) => idx < 3 ? 'rgba(34, 197, 94, 1)' : 'rgba(34, 197, 94, 0.6)'),\n      borderWidth: 1\n    }]\n  };\n  const chartOptions = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: {\n        display: false\n      },\n      tooltip: {\n        callbacks: {\n          label: context => {\n            const user = userCoverageData[context.dataIndex];\n            return `${user.userName}: ${user.totalPortfolios} portfolios`;\n          }\n        }\n      }\n    },\n    scales: {\n      y: {\n        beginAtZero: true,\n        ticks: {\n          stepSize: 1\n        },\n        title: {\n          display: true,\n          text: 'Total Portfolios Monitored'\n        }\n      },\n      x: {\n        title: {\n          display: true,\n          text: 'Users'\n        }\n      }\n    }\n  };\n  const cellInfo = hoveredCell ? getCellInfo(hoveredCell.userId, hoveredCell.hour) : null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold text-gray-900\",\n          children: \"Coverage Matrix\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mt-1\",\n          children: \"Comprehensive grid view showing portfolio coverage by user and hour\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleResetFilters,\n          variant: \"secondary\",\n          children: \"Reset All Filters\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleExportCSV,\n          variant: \"primary\",\n          children: \"Export Matrix\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-4 gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"User Search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: userSearch,\n            onChange: e => setUserSearch(e.target.value),\n            placeholder: \"Search users...\",\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Hour Filter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: hourFilter,\n            onChange: e => setHourFilter(e.target.value),\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"all\",\n              children: \"All Hours\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 15\n            }, this), Array.from({\n              length: 24\n            }, (_, i) => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: i.toString(),\n              children: [i, \":00\"]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Issue Filter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: issueFilter,\n            onChange: e => setIssueFilter(e.target.value),\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"all\",\n              children: \"All Issues (Coverage)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"active\",\n              children: \"Active Issues Only\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Date Range\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: dateRange,\n            onChange: e => setDateRange(e.target.value),\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"today\",\n              children: \"Today\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"yesterday\",\n              children: \"Yesterday\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"week\",\n              children: \"Week\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"month\",\n              children: \"Month\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"custom\",\n              children: \"Custom Range\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this), dateRange === 'custom' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 mt-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"From Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: customStartDate,\n            onChange: e => setCustomStartDate(e.target.value),\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"To Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: customEndDate,\n            onChange: e => setCustomEndDate(e.target.value),\n            className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-gray-50\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase sticky left-0 bg-gray-50 z-10 border-r border-gray-200\",\n                children: \"User\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 17\n              }, this), Array.from({\n                length: 24\n              }, (_, i) => /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase min-w-[50px]\",\n                children: i\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 479,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase bg-gray-100\",\n                children: \"Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 486,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"bg-white divide-y divide-gray-200\",\n            children: matrixData.length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: /*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: 26,\n                className: \"px-4 py-8 text-center text-gray-500\",\n                children: \"No data available\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 494,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 493,\n              columnNumber: 17\n            }, this) : matrixData.map(row => {\n              const total = Object.values(row.hours).reduce((sum, issues) => sum + issues.length, 0);\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"hover:bg-gray-50\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-3 text-sm font-medium text-gray-900 sticky left-0 bg-white z-10 border-r border-gray-200\",\n                  children: row.displayName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 506,\n                  columnNumber: 23\n                }, this), Array.from({\n                  length: 24\n                }, (_, hour) => {\n                  const issues = row.hours[hour] || [];\n                  const count = issues.length;\n                  return /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: `px-2 py-3 text-center text-xs font-semibold cursor-pointer transition-colors ${getCellToneClass(count, maxCount)}`,\n                    onMouseEnter: e => handleCellMouseEnter(e, row.userName, hour),\n                    onMouseLeave: handleCellMouseLeave,\n                    title: `${row.displayName} - Hour ${hour}:00 - ${count} issue(s)`,\n                    children: count > 0 ? count : ''\n                  }, hour, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 513,\n                    columnNumber: 27\n                  }, this);\n                }), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-3 text-center text-sm font-bold text-gray-900 bg-gray-100\",\n                  children: total\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 527,\n                  columnNumber: 23\n                }, this)]\n              }, row.userName, true, {\n                fileName: _jsxFileName,\n                lineNumber: 505,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 7\n    }, this), hoveredCell && cellInfo && (cellInfo.portfolios.length > 0 || cellInfo.issuesYes.length > 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed z-[9999] w-80 bg-gray-900 text-white text-xs rounded-lg shadow-xl p-4 pointer-events-none\",\n      style: {\n        top: `${hoveredCell.position.top}px`,\n        left: `${hoveredCell.position.left}px`,\n        transform: hoveredCell.position.showAbove ? 'translate(-50%, -100%)' : 'translate(-50%, 0)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"font-bold text-sm mb-2 pb-2 border-b border-gray-700\",\n        children: [((_matrixData$find = matrixData.find(u => u.userName === hoveredCell.userId)) === null || _matrixData$find === void 0 ? void 0 : _matrixData$find.displayName) || 'Unknown', \" - Hour\", ' ', hoveredCell.hour, \":00\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 551,\n        columnNumber: 11\n      }, this), cellInfo.totalIssuesCount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-semibold text-blue-400 mb-1\",\n          children: [\"Total Count (All Issues): \", cellInfo.totalIssuesCount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 557,\n        columnNumber: 13\n      }, this), cellInfo.totalCount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-semibold text-green-400 mb-1\",\n          children: [\"Total Portfolios Monitored (\", cellInfo.totalCount, \"):\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1 max-h-32 overflow-y-auto\",\n          children: cellInfo.portfolioInstances && cellInfo.portfolioInstances.length > 0 ? cellInfo.portfolioInstances.map((item, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-gray-200 pl-2\",\n            children: [\"\\u2022 \", item.portfolio, item.caseNumber && item.caseNumber !== 'N/A' && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-400 ml-2\",\n              children: [\"(Case: \", item.caseNumber, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 575,\n              columnNumber: 27\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 23\n          }, this)) : cellInfo.portfolios.map((portfolio, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-gray-200 pl-2\",\n            children: [\"\\u2022 \", portfolio]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 23\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 13\n      }, this), cellInfo.issuesYes.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-semibold text-red-400 mb-1\",\n          children: [\"Active Issues (\", cellInfo.issuesYes.length, \"):\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2 max-h-40 overflow-y-auto\",\n          children: cellInfo.issuesYes.map((issue, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-800 rounded p-2 border-l-2 border-red-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium text-white\",\n              children: issue.portfolio\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 596,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-300 text-xs mt-1\",\n              children: issue.details\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-400 text-xs mt-1\",\n              children: [\"Case: \", issue.caseNumber, \" \\u2022 \", issue.date]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 598,\n              columnNumber: 21\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 595,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 589,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `absolute left-1/2 transform -translate-x-1/2 border-4 border-transparent ${hoveredCell.position.showAbove ? 'top-full -mt-1 border-t-gray-900' : 'bottom-full mb-1 border-b-gray-900'}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 607,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 541,\n      columnNumber: 9\n    }, this), userCoverageData.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold text-gray-900 mb-4\",\n        children: \"User Coverage Performance\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 620,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: '400px'\n        },\n        children: /*#__PURE__*/_jsxDEV(Bar, {\n          data: chartData,\n          options: chartOptions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 622,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 621,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 619,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 371,\n    columnNumber: 5\n  }, this);\n};\n_s(CoverageMatrix, \"oQX8aUkeEzWkWE1KV4Yh9wamJ7M=\", false, function () {\n  return [useAuth, useQuery, useQuery];\n});\n_c = CoverageMatrix;\nexport default CoverageMatrix;\nvar _c;\n$RefreshReg$(_c, \"CoverageMatrix\");","map":{"version":3,"names":["React","useState","useMemo","useQuery","Bar","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","issueService","adminService","useAuth","Card","Button","toast","jsxDEV","_jsxDEV","register","getCellToneClass","count","max","ratio","CoverageMatrix","_s","_matrixData$find","user","currentUser","userSearch","setUserSearch","hourFilter","setHourFilter","issueFilter","setIssueFilter","dateRange","setDateRange","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","hoveredCell","setHoveredCell","data","users","queryKey","queryFn","getUsers","allIssues","getAll","filteredIssues","filtered","today","Date","setHours","filter","issue","issueDate","created_at","getTime","yesterday","setDate","getDate","weekAgo","monthAgo","setMonth","getMonth","start","end","description","toLowerCase","hour","parseInt","issue_hour","matrixData","userMap","forEach","_issue$monitored_by","monitoredBy","monitored_by","username","split","displayName","userName","hours","push","filteredUsers","Object","values","includes","maxCount","issues","Math","length","getCellInfo","userId","find","u","portfolios","Set","map","i","portfolio_id","issuesYes","portfolioInstances","Array","from","portfolioId","_portfolioIssues$","_portfolioIssues$$por","_portfolioIssues$2","_portfolioIssues$2$no","_portfolioIssues$2$no2","portfolioIssues","portfolioName","portfolio","name","caseNumber","notes","match","totalIssuesCount","totalCount","size","id","_issue$portfolio","_issue$portfolio2","_issue$notes","_issue$notes$match","details","date","toLocaleString","handleCellMouseEnter","e","rect","currentTarget","getBoundingClientRect","viewportHeight","window","innerHeight","spaceAbove","top","spaceBelow","bottom","showAbove","position","left","width","handleCellMouseLeave","handleResetFilters","handleExportCSV","csvRows","_","row","total","_user$hours$hour","toString","reduce","sum","_user$hours$hour2","s","csvContent","join","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","toISOString","click","revokeObjectURL","success","userCoverageData","totalPortfolios","flatMap","sort","b","slice","chartData","labels","substring","datasets","label","backgroundColor","idx","borderColor","borderWidth","chartOptions","responsive","maintainAspectRatio","plugins","legend","display","tooltip","callbacks","context","dataIndex","scales","y","beginAtZero","ticks","stepSize","title","text","x","cellInfo","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","variant","value","onChange","target","placeholder","colSpan","onMouseEnter","onMouseLeave","style","transform","item","height","options","_c","$RefreshReg$"],"sources":["C:/Users/LibsysAdmin/OneDrive - Libsys IT Services Private Limited/Desktop/ALLLL HLSC/client/src/components/analytics/CoverageMatrix.tsx"],"sourcesContent":["import React, { useState, useMemo, useRef } from 'react'\r\nimport { useQuery } from '@tanstack/react-query'\r\nimport { Bar } from 'react-chartjs-2'\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n} from 'chart.js'\r\nimport { issueService } from '../../services/issueService'\r\nimport { adminService } from '../../services/adminService'\r\nimport { Issue } from '../../types/issue.types'\r\nimport { User } from '../../types/user.types'\r\nimport { useAuth } from '../../context/AuthContext'\r\nimport Card from '../common/Card'\r\nimport Button from '../common/Button'\r\nimport toast from 'react-hot-toast'\r\n\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend)\r\n\r\nconst getCellToneClass = (count: number, max: number) => {\r\n  if (!count || max === 0) {\r\n    return 'bg-gray-50 border border-gray-100 text-gray-400'\r\n  }\r\n\r\n  const ratio = count / max\r\n\r\n  if (ratio >= 0.8) {\r\n    return 'bg-green-600 text-white'\r\n  }\r\n  if (ratio >= 0.6) {\r\n    return 'bg-green-500 text-white'\r\n  }\r\n  if (ratio >= 0.4) {\r\n    return 'bg-green-400 text-white'\r\n  }\r\n  if (ratio >= 0.2) {\r\n    return 'bg-green-200 text-green-900'\r\n  }\r\n  return 'bg-green-100 text-green-800'\r\n}\r\n\r\nconst CoverageMatrix: React.FC = () => {\r\n  const { user: currentUser } = useAuth()\r\n  const [userSearch, setUserSearch] = useState('')\r\n  const [hourFilter, setHourFilter] = useState<string>('all')\r\n  const [issueFilter, setIssueFilter] = useState<'all' | 'active'>('all')\r\n  const [dateRange, setDateRange] = useState<'today' | 'yesterday' | 'week' | 'month' | 'custom'>('today')\r\n  const [customStartDate, setCustomStartDate] = useState('')\r\n  const [customEndDate, setCustomEndDate] = useState('')\r\n  const [hoveredCell, setHoveredCell] = useState<{\r\n    userId: string\r\n    hour: number\r\n    position: { top: number; left: number; showAbove: boolean }\r\n  } | null>(null)\r\n\r\n  // Fetch users\r\n  const { data: users = [] } = useQuery<User[]>({\r\n    queryKey: ['admin-users'],\r\n    queryFn: adminService.getUsers,\r\n  })\r\n\r\n  // Fetch issues\r\n  const { data: allIssues = [] } = useQuery<Issue[]>({\r\n    queryKey: ['issues'],\r\n    queryFn: () => issueService.getAll({}),\r\n  })\r\n\r\n  // Filter issues based on date range and issue filter\r\n  const filteredIssues = useMemo(() => {\r\n    let filtered = allIssues\r\n\r\n    // Date range filter\r\n    const today = new Date()\r\n    today.setHours(0, 0, 0, 0)\r\n\r\n    if (dateRange === 'today') {\r\n      filtered = filtered.filter((issue) => {\r\n        const issueDate = new Date(issue.created_at)\r\n        issueDate.setHours(0, 0, 0, 0)\r\n        return issueDate.getTime() === today.getTime()\r\n      })\r\n    } else if (dateRange === 'yesterday') {\r\n      const yesterday = new Date(today)\r\n      yesterday.setDate(yesterday.getDate() - 1)\r\n      filtered = filtered.filter((issue) => {\r\n        const issueDate = new Date(issue.created_at)\r\n        issueDate.setHours(0, 0, 0, 0)\r\n        return issueDate.getTime() === yesterday.getTime()\r\n      })\r\n    } else if (dateRange === 'week') {\r\n      const weekAgo = new Date(today)\r\n      weekAgo.setDate(today.getDate() - 7)\r\n      filtered = filtered.filter((issue) => {\r\n        const issueDate = new Date(issue.created_at)\r\n        return issueDate >= weekAgo\r\n      })\r\n    } else if (dateRange === 'month') {\r\n      const monthAgo = new Date(today)\r\n      monthAgo.setMonth(today.getMonth() - 1)\r\n      filtered = filtered.filter((issue) => {\r\n        const issueDate = new Date(issue.created_at)\r\n        return issueDate >= monthAgo\r\n      })\r\n    } else if (dateRange === 'custom' && customStartDate && customEndDate) {\r\n      const start = new Date(customStartDate)\r\n      const end = new Date(customEndDate)\r\n      end.setHours(23, 59, 59, 999)\r\n      filtered = filtered.filter((issue) => {\r\n        const issueDate = new Date(issue.created_at)\r\n        return issueDate >= start && issueDate <= end\r\n      })\r\n    }\r\n\r\n    // Issue filter\r\n    if (issueFilter === 'active') {\r\n      filtered = filtered.filter(\r\n        (issue) => issue.description && issue.description.toLowerCase() !== 'no issue'\r\n      )\r\n    }\r\n\r\n    // Hour filter\r\n    if (hourFilter !== 'all') {\r\n      const hour = parseInt(hourFilter)\r\n      filtered = filtered.filter((issue) => issue.issue_hour === hour)\r\n    }\r\n\r\n    return filtered\r\n  }, [allIssues, dateRange, customStartDate, customEndDate, issueFilter, hourFilter])\r\n\r\n  // Build matrix data\r\n  const matrixData = useMemo(() => {\r\n    const userMap: {\r\n      [key: string]: {\r\n        userName: string\r\n        displayName: string\r\n        hours: { [hour: number]: Issue[] }\r\n      }\r\n    } = {}\r\n\r\n    filteredIssues.forEach((issue) => {\r\n      const monitoredBy = issue.monitored_by?.[0] || 'Unknown'\r\n      const username = monitoredBy.split('@')[0]\r\n      const displayName = username || 'Unknown'\r\n\r\n      if (!userMap[monitoredBy]) {\r\n        userMap[monitoredBy] = {\r\n          userName: monitoredBy,\r\n          displayName,\r\n          hours: {},\r\n        }\r\n      }\r\n\r\n      const hour = issue.issue_hour\r\n      if (!userMap[monitoredBy].hours[hour]) {\r\n        userMap[monitoredBy].hours[hour] = []\r\n      }\r\n      userMap[monitoredBy].hours[hour].push(issue)\r\n    })\r\n\r\n    // Filter by user search\r\n    const filteredUsers = Object.values(userMap).filter((user) =>\r\n      user.displayName.toLowerCase().includes(userSearch.toLowerCase()) ||\r\n      user.userName.toLowerCase().includes(userSearch.toLowerCase())\r\n    )\r\n\r\n    return filteredUsers\r\n  }, [filteredIssues, userSearch])\r\n\r\n  // Calculate max count for color coding\r\n  const maxCount = useMemo(() => {\r\n    let max = 0\r\n    matrixData.forEach((user) => {\r\n      Object.values(user.hours).forEach((issues) => {\r\n        max = Math.max(max, issues.length)\r\n      })\r\n    })\r\n    return max\r\n  }, [matrixData])\r\n\r\n  // Get cell info for tooltip\r\n  const getCellInfo = (userId: string, hour: number) => {\r\n    const user = matrixData.find((u) => u.userName === userId)\r\n    if (!user) return null\r\n\r\n    const issues = user.hours[hour] || []\r\n    const portfolios = new Set(issues.map((i) => i.portfolio_id))\r\n    const issuesYes = issues.filter(\r\n      (i) => i.description && i.description.toLowerCase() !== 'no issue'\r\n    )\r\n\r\n    const portfolioInstances = Array.from(portfolios).map((portfolioId) => {\r\n      const portfolioIssues = issues.filter((i) => i.portfolio_id === portfolioId)\r\n      const portfolioName = portfolioIssues[0]?.portfolio?.name || 'Unknown'\r\n      const caseNumber = portfolioIssues[0]?.notes?.match(/Case #:\\s*(.+)/)?.[1] || 'N/A'\r\n      return { portfolio: portfolioName, caseNumber }\r\n    })\r\n\r\n    return {\r\n      totalIssuesCount: issues.length,\r\n      totalCount: portfolios.size,\r\n      portfolios: Array.from(portfolios).map((id) => {\r\n        const issue = issues.find((i) => i.portfolio_id === id)\r\n        return issue?.portfolio?.name || 'Unknown'\r\n      }),\r\n      portfolioInstances,\r\n      issuesYes: issuesYes.map((issue) => ({\r\n        portfolio: issue.portfolio?.name || 'Unknown',\r\n        details: issue.description || '',\r\n        caseNumber: issue.notes?.match(/Case #:\\s*(.+)/)?.[1] || 'N/A',\r\n        date: new Date(issue.created_at).toLocaleString(),\r\n      })),\r\n    }\r\n  }\r\n\r\n  const handleCellMouseEnter = (\r\n    e: React.MouseEvent<HTMLTableCellElement>,\r\n    userId: string,\r\n    hour: number\r\n  ) => {\r\n    const rect = e.currentTarget.getBoundingClientRect()\r\n    const viewportHeight = window.innerHeight\r\n    const spaceAbove = rect.top\r\n    const spaceBelow = viewportHeight - rect.bottom\r\n\r\n    const showAbove = spaceAbove > spaceBelow\r\n\r\n    setHoveredCell({\r\n      userId,\r\n      hour,\r\n      position: {\r\n        top: showAbove ? rect.top - 10 : rect.bottom + 10,\r\n        left: rect.left + rect.width / 2,\r\n        showAbove,\r\n      },\r\n    })\r\n  }\r\n\r\n  const handleCellMouseLeave = () => {\r\n    setHoveredCell(null)\r\n  }\r\n\r\n  const handleResetFilters = () => {\r\n    setUserSearch('')\r\n    setHourFilter('all')\r\n    setIssueFilter('all')\r\n    setDateRange('today')\r\n    setCustomStartDate('')\r\n    setCustomEndDate('')\r\n  }\r\n\r\n  const handleExportCSV = () => {\r\n    const csvRows = [\r\n      ['User', ...Array.from({ length: 24 }, (_, i) => `${i}`), 'Total'],\r\n      ...matrixData.map((user) => {\r\n        const row = [user.displayName]\r\n        let total = 0\r\n        for (let hour = 0; hour < 24; hour++) {\r\n          const count = user.hours[hour]?.length || 0\r\n          row.push(count.toString())\r\n          total += count\r\n        }\r\n        row.push(total.toString())\r\n        return row\r\n      }),\r\n      [\r\n        'Total',\r\n        ...Array.from({ length: 24 }, (_, hour) => {\r\n          const count = matrixData.reduce(\r\n            (sum, user) => sum + (user.hours[hour]?.length || 0),\r\n            0\r\n          )\r\n          return count.toString()\r\n        }),\r\n        matrixData.reduce((sum, user) => {\r\n          return sum + Object.values(user.hours).reduce((s, issues) => s + issues.length, 0)\r\n        }, 0).toString(),\r\n      ],\r\n    ]\r\n\r\n    const csvContent = csvRows.map((row) => row.join(',')).join('\\n')\r\n    const blob = new Blob([csvContent], { type: 'text/csv' })\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `user_hour_coverage_matrix_${new Date().toISOString().split('T')[0]}.csv`\r\n    a.click()\r\n    window.URL.revokeObjectURL(url)\r\n    toast.success('Coverage matrix exported successfully')\r\n  }\r\n\r\n  // Calculate user coverage for chart\r\n  const userCoverageData = useMemo(() => {\r\n    return matrixData\r\n      .map((user) => {\r\n        const totalPortfolios = new Set(\r\n          Object.values(user.hours).flatMap((issues) => issues.map((i) => i.portfolio_id))\r\n        ).size\r\n        return {\r\n          userName: user.displayName,\r\n          totalPortfolios,\r\n        }\r\n      })\r\n      .sort((a, b) => b.totalPortfolios - a.totalPortfolios)\r\n      .slice(0, 10)\r\n  }, [matrixData])\r\n\r\n  const chartData = {\r\n    labels: userCoverageData.map((u) =>\r\n      u.userName.length > 20 ? u.userName.substring(0, 20) + '...' : u.userName\r\n    ),\r\n    datasets: [\r\n      {\r\n        label: 'Total Portfolios Monitored',\r\n        data: userCoverageData.map((u) => u.totalPortfolios),\r\n        backgroundColor: userCoverageData.map((_, idx) =>\r\n          idx < 3\r\n            ? 'rgba(34, 197, 94, 0.8)'\r\n            : 'rgba(34, 197, 94, 0.4)'\r\n        ),\r\n        borderColor: userCoverageData.map((_, idx) =>\r\n          idx < 3 ? 'rgba(34, 197, 94, 1)' : 'rgba(34, 197, 94, 0.6)'\r\n        ),\r\n        borderWidth: 1,\r\n      },\r\n    ],\r\n  }\r\n\r\n  const chartOptions = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: {\r\n        display: false,\r\n      },\r\n      tooltip: {\r\n        callbacks: {\r\n          label: (context: any) => {\r\n            const user = userCoverageData[context.dataIndex]\r\n            return `${user.userName}: ${user.totalPortfolios} portfolios`\r\n          },\r\n        },\r\n      },\r\n    },\r\n    scales: {\r\n      y: {\r\n        beginAtZero: true,\r\n        ticks: {\r\n          stepSize: 1,\r\n        },\r\n        title: {\r\n          display: true,\r\n          text: 'Total Portfolios Monitored',\r\n        },\r\n      },\r\n      x: {\r\n        title: {\r\n          display: true,\r\n          text: 'Users',\r\n        },\r\n      },\r\n    },\r\n  }\r\n\r\n  const cellInfo = hoveredCell ? getCellInfo(hoveredCell.userId, hoveredCell.hour) : null\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Coverage Matrix</h1>\r\n          <p className=\"text-gray-600 mt-1\">Comprehensive grid view showing portfolio coverage by user and hour</p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button onClick={handleResetFilters} variant=\"secondary\">\r\n            Reset All Filters\r\n          </Button>\r\n          <Button onClick={handleExportCSV} variant=\"primary\">\r\n            Export Matrix\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">User Search</label>\r\n            <input\r\n              type=\"text\"\r\n              value={userSearch}\r\n              onChange={(e) => setUserSearch(e.target.value)}\r\n              placeholder=\"Search users...\"\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Hour Filter</label>\r\n            <select\r\n              value={hourFilter}\r\n              onChange={(e) => setHourFilter(e.target.value)}\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"all\">All Hours</option>\r\n              {Array.from({ length: 24 }, (_, i) => (\r\n                <option key={i} value={i.toString()}>\r\n                  {i}:00\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Issue Filter</label>\r\n            <select\r\n              value={issueFilter}\r\n              onChange={(e) => setIssueFilter(e.target.value as 'all' | 'active')}\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"all\">All Issues (Coverage)</option>\r\n              <option value=\"active\">Active Issues Only</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Date Range</label>\r\n            <select\r\n              value={dateRange}\r\n              onChange={(e) => setDateRange(e.target.value as any)}\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"today\">Today</option>\r\n              <option value=\"yesterday\">Yesterday</option>\r\n              <option value=\"week\">Week</option>\r\n              <option value=\"month\">Month</option>\r\n              <option value=\"custom\">Custom Range</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {dateRange === 'custom' && (\r\n          <div className=\"grid grid-cols-2 gap-4 mt-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">From Date</label>\r\n              <input\r\n                type=\"date\"\r\n                value={customStartDate}\r\n                onChange={(e) => setCustomStartDate(e.target.value)}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">To Date</label>\r\n              <input\r\n                type=\"date\"\r\n                value={customEndDate}\r\n                onChange={(e) => setCustomEndDate(e.target.value)}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </Card>\r\n\r\n      {/* Matrix Table */}\r\n      <Card>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase sticky left-0 bg-gray-50 z-10 border-r border-gray-200\">\r\n                  User\r\n                </th>\r\n                {Array.from({ length: 24 }, (_, i) => (\r\n                  <th\r\n                    key={i}\r\n                    className=\"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase min-w-[50px]\"\r\n                  >\r\n                    {i}\r\n                  </th>\r\n                ))}\r\n                <th className=\"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase bg-gray-100\">\r\n                  Total\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {matrixData.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={26} className=\"px-4 py-8 text-center text-gray-500\">\r\n                    No data available\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                matrixData.map((row) => {\r\n                  const total = Object.values(row.hours).reduce(\r\n                    (sum, issues) => sum + issues.length,\r\n                    0\r\n                  )\r\n                  return (\r\n                    <tr key={row.userName} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-4 py-3 text-sm font-medium text-gray-900 sticky left-0 bg-white z-10 border-r border-gray-200\">\r\n                        {row.displayName}\r\n                      </td>\r\n                      {Array.from({ length: 24 }, (_, hour) => {\r\n                        const issues = row.hours[hour] || []\r\n                        const count = issues.length\r\n                        return (\r\n                          <td\r\n                            key={hour}\r\n                            className={`px-2 py-3 text-center text-xs font-semibold cursor-pointer transition-colors ${getCellToneClass(\r\n                              count,\r\n                              maxCount\r\n                            )}`}\r\n                            onMouseEnter={(e) => handleCellMouseEnter(e, row.userName, hour)}\r\n                            onMouseLeave={handleCellMouseLeave}\r\n                            title={`${row.displayName} - Hour ${hour}:00 - ${count} issue(s)`}\r\n                          >\r\n                            {count > 0 ? count : ''}\r\n                          </td>\r\n                        )\r\n                      })}\r\n                      <td className=\"px-4 py-3 text-center text-sm font-bold text-gray-900 bg-gray-100\">\r\n                        {total}\r\n                      </td>\r\n                    </tr>\r\n                  )\r\n                })\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Hover Tooltip */}\r\n      {hoveredCell && cellInfo && (cellInfo.portfolios.length > 0 || cellInfo.issuesYes.length > 0) && (\r\n        <div\r\n          className=\"fixed z-[9999] w-80 bg-gray-900 text-white text-xs rounded-lg shadow-xl p-4 pointer-events-none\"\r\n          style={{\r\n            top: `${hoveredCell.position.top}px`,\r\n            left: `${hoveredCell.position.left}px`,\r\n            transform: hoveredCell.position.showAbove\r\n              ? 'translate(-50%, -100%)'\r\n              : 'translate(-50%, 0)',\r\n          }}\r\n        >\r\n          <div className=\"font-bold text-sm mb-2 pb-2 border-b border-gray-700\">\r\n            {matrixData.find((u) => u.userName === hoveredCell.userId)?.displayName || 'Unknown'} - Hour{' '}\r\n            {hoveredCell.hour}:00\r\n          </div>\r\n\r\n          {cellInfo.totalIssuesCount > 0 && (\r\n            <div className=\"mb-3\">\r\n              <div className=\"font-semibold text-blue-400 mb-1\">\r\n                Total Count (All Issues): {cellInfo.totalIssuesCount}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {cellInfo.totalCount > 0 && (\r\n            <div className=\"mb-3\">\r\n              <div className=\"font-semibold text-green-400 mb-1\">\r\n                Total Portfolios Monitored ({cellInfo.totalCount}):\r\n              </div>\r\n              <div className=\"space-y-1 max-h-32 overflow-y-auto\">\r\n                {cellInfo.portfolioInstances && cellInfo.portfolioInstances.length > 0\r\n                  ? cellInfo.portfolioInstances.map((item, idx) => (\r\n                      <div key={idx} className=\"text-gray-200 pl-2\">\r\n                         {item.portfolio}\r\n                        {item.caseNumber && item.caseNumber !== 'N/A' && (\r\n                          <span className=\"text-gray-400 ml-2\">(Case: {item.caseNumber})</span>\r\n                        )}\r\n                      </div>\r\n                    ))\r\n                  : cellInfo.portfolios.map((portfolio, idx) => (\r\n                      <div key={idx} className=\"text-gray-200 pl-2\">\r\n                         {portfolio}\r\n                      </div>\r\n                    ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {cellInfo.issuesYes.length > 0 && (\r\n            <div>\r\n              <div className=\"font-semibold text-red-400 mb-1\">\r\n                Active Issues ({cellInfo.issuesYes.length}):\r\n              </div>\r\n              <div className=\"space-y-2 max-h-40 overflow-y-auto\">\r\n                {cellInfo.issuesYes.map((issue, idx) => (\r\n                  <div key={idx} className=\"bg-gray-800 rounded p-2 border-l-2 border-red-500\">\r\n                    <div className=\"font-medium text-white\">{issue.portfolio}</div>\r\n                    <div className=\"text-gray-300 text-xs mt-1\">{issue.details}</div>\r\n                    <div className=\"text-gray-400 text-xs mt-1\">\r\n                      Case: {issue.caseNumber}  {issue.date}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div\r\n            className={`absolute left-1/2 transform -translate-x-1/2 border-4 border-transparent ${\r\n              hoveredCell.position.showAbove\r\n                ? 'top-full -mt-1 border-t-gray-900'\r\n                : 'bottom-full mb-1 border-b-gray-900'\r\n            }`}\r\n          ></div>\r\n        </div>\r\n      )}\r\n\r\n      {/* User Coverage Performance Chart */}\r\n      {userCoverageData.length > 0 && (\r\n        <Card>\r\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">User Coverage Performance</h2>\r\n          <div style={{ height: '400px' }}>\r\n            <Bar data={chartData} options={chartOptions} />\r\n          </div>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CoverageMatrix\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}