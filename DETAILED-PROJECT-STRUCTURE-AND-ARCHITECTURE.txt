# Multi-Tenant Application - Complete Project Structure & Architecture
## ğŸ“‹ Table of Contents
1. [Project Overview](#project-overview)
2. [Complete Folder Structure](#complete-folder-structure)
3. [System Architecture](#system-architecture)
4. [Database Design & ER Diagram](#database-design--er-diagram)
5. [Technology Stack Details](#technology-stack-details)
6. [API Endpoints Documentation](#api-endpoints-documentation)
7. [Authentication Flow](#authentication-flow)
8. [Data Flow Diagrams](#data-flow-diagrams)
---
## Project Overview
**Project Name:** Multi-Tenant Portfolio Issue Tracker  
**Type:** SaaS (Software as a Service)  
**Architecture:** Multi-Tenant with Data Isolation  
**Frontend:** React.js (TypeScript)  
**Backend:** Node.js + Express.js  
**Database:** PostgreSQL (via Supabase)  
**Deployment:** FREE tier (Vercel + Railway + Supabase)
---
## Complete Folder Structure
```
multi-tenant-portfolio-tracker/
â”‚
â”œâ”€â”€ ğŸ“ client/                                    # Frontend Application (React)
â”‚   â”œâ”€â”€ ğŸ“ public/                                # Static files served directly
â”‚   â”‚   â”œâ”€â”€ index.html                            # Main HTML template
â”‚   â”‚   â”œâ”€â”€ favicon.ico                           # App favicon
â”‚   â”‚   â”œâ”€â”€ logo192.png                           # PWA icon (192x192)
â”‚   â”‚   â”œâ”€â”€ logo512.png                           # PWA icon (512x512)
â”‚   â”‚   â”œâ”€â”€ manifest.json                         # PWA manifest
â”‚   â”‚   â””â”€â”€ robots.txt                            # SEO robots file
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ src/                                   # Source code
â”‚   â”‚   â”œâ”€â”€ ğŸ“ assets/                            # Static assets (images, fonts)
â”‚   â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ logo.svg                      # App logo
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ default-avatar.png            # Default user avatar
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ empty-state.svg               # Empty state illustrations
â”‚   â”‚   â”‚   â””â”€â”€ fonts/
â”‚   â”‚   â”‚       â””â”€â”€ CustomFont.ttf                # Custom fonts (optional)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/                        # React Components
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ auth/                          # Authentication components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserLogin.tsx                 # User login form
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminLogin.tsx                # Admin login form
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ForgotPassword.tsx            # Password reset form
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PrivateRoute.tsx              # Protected route wrapper
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ common/                        # Reusable UI components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx                    # Custom button component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Input.tsx                     # Custom input component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Textarea.tsx                  # Custom textarea
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Select.tsx                    # Custom select dropdown
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Checkbox.tsx                  # Custom checkbox
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Radio.tsx                     # Custom radio button
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.tsx                     # Reusable modal component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Table.tsx                     # Reusable table component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx                      # Card component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Badge.tsx                     # Badge component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Tooltip.tsx                   # Tooltip component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Spinner.tsx                   # Loading spinner
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Toast.tsx                     # Toast notification
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Tabs.tsx                      # Tab navigation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Pagination.tsx                # Pagination component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SearchBar.tsx                 # Search input
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DatePicker.tsx                # Date picker
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EmptyState.tsx                # Empty state UI
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ErrorBoundary.tsx             # Error boundary
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ layout/                        # Layout components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Navbar.tsx                    # Top navigation bar
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx                   # Side navigation menu
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx                    # Footer component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx                # Main layout wrapper
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AuthLayout.tsx                # Auth pages layout
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ dashboard/                     # Dashboard components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx                 # Main dashboard page
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCard.tsx                 # Stats card component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ QuickActions.tsx              # Quick action buttons
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ RecentActivity.tsx            # Recent activity widget
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ portfolio/                     # Portfolio components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioList.tsx             # List of portfolios
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioCard.tsx             # Single portfolio card
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioForm.tsx             # Add/Edit portfolio form
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioDetails.tsx          # Portfolio detail view
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioStatusHeatMap.tsx    # Status heat map
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioHeatMap.tsx          # Coverage heat map
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioMonitoringMatrix.tsx # Hour Ã— Portfolio matrix
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PortfolioHourSessionDrawer.tsx # Session info drawer
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ issues/                        # Issue tracking components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssueList.tsx                 # Issues table view
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssueForm.tsx                 # Log new issue form
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssueCard.tsx                 # Single issue card
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssueDetailsView.tsx          # Issue detail modal
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EditIssueModal.tsx            # Edit issue modal
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssuesTable.tsx               # Advanced table
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssuesByUser.tsx              # Issues grouped by user
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TicketLoggingTable.tsx        # Ticket logging view
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ analytics/                     # Analytics components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HourlyCoverageChart.tsx       # Coverage chart by hour
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IssuesChart.tsx               # Issues statistics chart
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CoverageChart.tsx             # General coverage chart
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PerformanceAnalytics.tsx      # Performance dashboard
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TrendChart.tsx                # Trend analysis chart
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ admin/                         # Admin components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminPanel.tsx                # Main admin panel
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminLogWidget.tsx            # Admin activity logs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserManagement.tsx            # Manage users
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PortfolioManagement.tsx       # Manage portfolios
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SystemSettings.tsx            # System settings
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ super-admin/                   # Super admin components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SuperAdminDashboard.tsx       # Super admin dashboard
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TenantList.tsx                # List all tenants
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TenantForm.tsx                # Add/Edit tenant
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TenantDetails.tsx             # Tenant detail view
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GlobalAnalytics.tsx           # Cross-tenant analytics
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BillingManagement.tsx         # Billing & subscriptions
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SystemMonitoring.tsx          # System health monitor
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ SinglePageComplete.tsx            # Main app container
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/                             # Custom React hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ useAuth.ts                        # Authentication hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useTenant.ts                      # Tenant context hook
â”‚   â”‚   â”‚   â”œâ”€â”€ usePermissions.ts                 # Permissions hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useApi.ts                         # API calls hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useDebounce.ts                    # Debounce hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useLocalStorage.ts                # localStorage hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useSessionStorage.ts              # sessionStorage hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useWindowSize.ts                  # Window resize hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useIntersectionObserver.ts        # Scroll visibility hook
â”‚   â”‚   â”‚   â””â”€â”€ useClickOutside.ts                # Click outside hook
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ context/                           # React Context providers
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx                   # Auth state context
â”‚   â”‚   â”‚   â”œâ”€â”€ TenantContext.tsx                 # Tenant state context
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeContext.tsx                  # Theme (light/dark)
â”‚   â”‚   â”‚   â””â”€â”€ NotificationContext.tsx           # Toast notifications
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/                          # API and external services
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts                            # Main API client
â”‚   â”‚   â”‚   â”œâ”€â”€ supabaseClient.ts                 # Supabase client
â”‚   â”‚   â”‚   â”œâ”€â”€ authService.ts                    # Auth API calls
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolioService.ts               # Portfolio API calls
â”‚   â”‚   â”‚   â”œâ”€â”€ issueService.ts                   # Issue API calls
â”‚   â”‚   â”‚   â”œâ”€â”€ userService.ts                    # User API calls
â”‚   â”‚   â”‚   â”œâ”€â”€ tenantService.ts                  # Tenant API calls
â”‚   â”‚   â”‚   â””â”€â”€ analyticsService.ts               # Analytics API calls
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ utils/                             # Utility functions
â”‚   â”‚   â”‚   â”œâ”€â”€ constants.ts                      # App constants
â”‚   â”‚   â”‚   â”œâ”€â”€ helpers.ts                        # Helper functions
â”‚   â”‚   â”‚   â”œâ”€â”€ validators.ts                     # Form validation
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters.ts                     # Data formatters
â”‚   â”‚   â”‚   â”œâ”€â”€ dateUtils.ts                      # Date/time utilities
â”‚   â”‚   â”‚   â”œâ”€â”€ colorUtils.ts                     # Color generation
â”‚   â”‚   â”‚   â”œâ”€â”€ exportUtils.ts                    # Excel/CSV export
â”‚   â”‚   â”‚   â””â”€â”€ permissions.ts                    # Permission checks
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types/                             # TypeScript types
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts                          # Main types export
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.types.ts                     # Auth types
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.types.ts                   # Tenant types
â”‚   â”‚   â”‚   â”œâ”€â”€ user.types.ts                     # User types
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.types.ts                # Portfolio types
â”‚   â”‚   â”‚   â”œâ”€â”€ issue.types.ts                    # Issue types
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.types.ts                # Analytics types
â”‚   â”‚   â”‚   â””â”€â”€ api.types.ts                      # API response types
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ styles/                            # CSS/SCSS styles
â”‚   â”‚   â”‚   â”œâ”€â”€ index.css                         # Main styles entry
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css                       # Global styles
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.css                     # CSS variables
â”‚   â”‚   â”‚   â”œâ”€â”€ tailwind.css                      # Tailwind base
â”‚   â”‚   â”‚   â””â”€â”€ animations.css                    # CSS animations
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.tsx                               # Main App component
â”‚   â”‚   â”œâ”€â”€ App.css                               # App styles
â”‚   â”‚   â”œâ”€â”€ index.tsx                             # React entry point
â”‚   â”‚   â”œâ”€â”€ index.css                             # Main CSS entry
â”‚   â”‚   â”œâ”€â”€ setupTests.ts                         # Test setup
â”‚   â”‚   â”œâ”€â”€ reportWebVitals.ts                    # Performance monitoring
â”‚   â”‚   â””â”€â”€ react-app-env.d.ts                    # React types
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ tests/                                 # Test files
â”‚   â”‚   â”œâ”€â”€ ğŸ“ unit/                              # Unit tests
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ integration/                       # Integration tests
â”‚   â”‚   â””â”€â”€ ğŸ“ e2e/                               # End-to-end tests
â”‚   â”‚
â”‚   â”œâ”€â”€ .env                                      # Environment variables (local)
â”‚   â”œâ”€â”€ .env.example                              # Environment template
â”‚   â”œâ”€â”€ .env.production                           # Production env
â”‚   â”œâ”€â”€ .gitignore                                # Git ignore rules
â”‚   â”œâ”€â”€ package.json                              # Dependencies
â”‚   â”œâ”€â”€ package-lock.json                         # Locked dependencies
â”‚   â”œâ”€â”€ tsconfig.json                             # TypeScript config
â”‚   â”œâ”€â”€ tailwind.config.js                        # Tailwind CSS config
â”‚   â”œâ”€â”€ postcss.config.js                         # PostCSS config
â”‚   â”œâ”€â”€ craco.config.js                           # Create React App config
â”‚   â””â”€â”€ README.md                                 # Frontend documentation
â”‚
â”œâ”€â”€ ğŸ“ server/                                    # Backend Application (Node.js)
â”‚   â”œâ”€â”€ ğŸ“ src/                                   # Source code
â”‚   â”‚   â”œâ”€â”€ ğŸ“ config/                            # Configuration files
â”‚   â”‚   â”‚   â”œâ”€â”€ database.config.ts                # Database connection
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.config.ts                    # Auth settings
â”‚   â”‚   â”‚   â”œâ”€â”€ cors.config.ts                    # CORS settings
â”‚   â”‚   â”‚   â”œâ”€â”€ supabase.config.ts                # Supabase settings
â”‚   â”‚   â”‚   â””â”€â”€ constants.ts                      # Server constants
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ routes/                            # API Routes
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts                          # Routes entry point
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.routes.ts                    # /api/auth/*
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.routes.ts                  # /api/tenants/*
â”‚   â”‚   â”‚   â”œâ”€â”€ user.routes.ts                    # /api/users/*
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.routes.ts               # /api/portfolios/*
â”‚   â”‚   â”‚   â”œâ”€â”€ issue.routes.ts                   # /api/issues/*
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.routes.ts               # /api/analytics/*
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.routes.ts                   # /api/admin/*
â”‚   â”‚   â”‚   â””â”€â”€ superadmin.routes.ts              # /api/super-admin/*
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ controllers/                       # Request handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts                # Auth logic
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.controller.ts              # Tenant CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ user.controller.ts                # User CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.controller.ts           # Portfolio CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ issue.controller.ts               # Issue CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.controller.ts           # Analytics logic
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.controller.ts               # Admin operations
â”‚   â”‚   â”‚   â””â”€â”€ superadmin.controller.ts          # Super admin ops
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/                          # Business logic layer
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts                   # Auth business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.service.ts                 # Tenant business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ user.service.ts                   # User business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.service.ts              # Portfolio business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ issue.service.ts                  # Issue business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.service.ts              # Analytics calculations
â”‚   â”‚   â”‚   â”œâ”€â”€ email.service.ts                  # Email notifications
â”‚   â”‚   â”‚   â””â”€â”€ export.service.ts                 # Excel/CSV export
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ middleware/                        # Express middleware
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts                # JWT verification
â”‚   â”‚   â”‚   â”œâ”€â”€ tenantIsolation.middleware.ts     # â­ Tenant data filter
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.middleware.ts          # Role-based access
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.middleware.ts          # Input validation
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimiter.middleware.ts         # Rate limiting
â”‚   â”‚   â”‚   â”œâ”€â”€ errorHandler.middleware.ts        # Error handling
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.middleware.ts              # Request logging
â”‚   â”‚   â”‚   â””â”€â”€ cors.middleware.ts                # CORS handling
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ models/                            # Database models/types
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts                          # Models export
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.model.ts                   # Tenant model
â”‚   â”‚   â”‚   â”œâ”€â”€ user.model.ts                     # User model
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.model.ts                # Portfolio model
â”‚   â”‚   â”‚   â”œâ”€â”€ issue.model.ts                    # Issue model
â”‚   â”‚   â”‚   â”œâ”€â”€ reservation.model.ts              # Hour reservation model
â”‚   â”‚   â”‚   â”œâ”€â”€ adminLog.model.ts                 # Admin log model
â”‚   â”‚   â”‚   â””â”€â”€ subscription.model.ts             # Subscription model
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ utils/                             # Utility functions
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.util.ts                       # JWT helper functions
â”‚   â”‚   â”‚   â”œâ”€â”€ password.util.ts                  # Bcrypt hashing
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.util.ts                # Data validation
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.util.ts                    # Winston logger
â”‚   â”‚   â”‚   â”œâ”€â”€ email.util.ts                     # Email helpers
â”‚   â”‚   â”‚   â”œâ”€â”€ date.util.ts                      # Date utilities
â”‚   â”‚   â”‚   â””â”€â”€ supabase.util.ts                  # Supabase helpers
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types/                             # TypeScript types
â”‚   â”‚   â”‚   â”œâ”€â”€ index.d.ts                        # Global types
â”‚   â”‚   â”‚   â”œâ”€â”€ express.d.ts                      # Express extensions
â”‚   â”‚   â”‚   â””â”€â”€ environment.d.ts                  # Env variables types
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ validators/                        # Validation schemas
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.validator.ts                 # Auth validation
â”‚   â”‚   â”‚   â”œâ”€â”€ tenant.validator.ts               # Tenant validation
â”‚   â”‚   â”‚   â”œâ”€â”€ user.validator.ts                 # User validation
â”‚   â”‚   â”‚   â”œâ”€â”€ portfolio.validator.ts            # Portfolio validation
â”‚   â”‚   â”‚   â””â”€â”€ issue.validator.ts                # Issue validation
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ app.ts                                # Express app setup
â”‚   â”‚   â””â”€â”€ server.ts                             # Server entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ tests/                                 # Backend tests
â”‚   â”‚   â”œâ”€â”€ ğŸ“ unit/                              # Unit tests
â”‚   â”‚   â”œâ”€â”€ ğŸ“ integration/                       # Integration tests
â”‚   â”‚   â””â”€â”€ setup.ts                              # Test setup
â”‚   â”‚
â”‚   â”œâ”€â”€ .env                                      # Environment variables
â”‚   â”œâ”€â”€ .env.example                              # Environment template
â”‚   â”œâ”€â”€ .gitignore                                # Git ignore rules
â”‚   â”œâ”€â”€ package.json                              # Dependencies
â”‚   â”œâ”€â”€ package-lock.json                         # Locked dependencies
â”‚   â”œâ”€â”€ tsconfig.json                             # TypeScript config
â”‚   â”œâ”€â”€ nodemon.json                              # Nodemon config
â”‚   â””â”€â”€ README.md                                 # Backend documentation
â”‚
â”œâ”€â”€ ğŸ“ database/                                  # Database related files
â”‚   â”œâ”€â”€ ğŸ“ migrations/                            # SQL migrations
â”‚   â”‚   â”œâ”€â”€ 001_create_tenants.sql                # Create tenants table
â”‚   â”‚   â”œâ”€â”€ 002_create_users.sql                  # Create users table
â”‚   â”‚   â”œâ”€â”€ 003_create_portfolios.sql             # Create portfolios table
â”‚   â”‚   â”œâ”€â”€ 004_create_issues.sql                 # Create issues table
â”‚   â”‚   â”œâ”€â”€ 005_create_hour_reservations.sql      # Create reservations
â”‚   â”‚   â”œâ”€â”€ 006_create_admin_logs.sql             # Create admin logs
â”‚   â”‚   â”œâ”€â”€ 007_create_monitored_personnel.sql    # Create monitored users
â”‚   â”‚   â”œâ”€â”€ 008_setup_rls_policies.sql            # Row Level Security
â”‚   â”‚   â”œâ”€â”€ 009_create_indexes.sql                # Database indexes
â”‚   â”‚   â””â”€â”€ 010_seed_data.sql                     # Initial seed data
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ seeds/                                 # Seed data
â”‚   â”‚   â”œâ”€â”€ dev_tenants.sql                       # Dev tenant data
â”‚   â”‚   â”œâ”€â”€ dev_users.sql                         # Dev user data
â”‚   â”‚   â””â”€â”€ dev_portfolios.sql                    # Dev portfolio data
â”‚   â”‚
â”‚   â”œâ”€â”€ schema.sql                                # Complete schema
â”‚   â”œâ”€â”€ schema.md                                 # Schema documentation
â”‚   â””â”€â”€ ER_DIAGRAM.md                             # ER diagram (text)
â”‚
â”œâ”€â”€ ğŸ“ docs/                                      # Documentation
â”‚   â”œâ”€â”€ API.md                                    # API documentation
â”‚   â”œâ”€â”€ SETUP.md                                  # Setup guide
â”‚   â”œâ”€â”€ DEPLOYMENT.md                             # Deployment guide
â”‚   â”œâ”€â”€ CONTRIBUTING.md                           # Contribution guide
â”‚   â”œâ”€â”€ SECURITY.md                               # Security guidelines
â”‚   â””â”€â”€ CHANGELOG.md                              # Version history
â”‚
â”œâ”€â”€ ğŸ“ scripts/                                   # Utility scripts
â”‚   â”œâ”€â”€ deploy.sh                                 # Deployment script
â”‚   â”œâ”€â”€ migrate.sh                                # Database migration
â”‚   â”œâ”€â”€ seed.sh                                   # Seed database
â”‚   â”œâ”€â”€ backup.sh                                 # Database backup
â”‚   â””â”€â”€ setup.sh                                  # Initial setup
â”‚
â”œâ”€â”€ ğŸ“ .github/                                   # GitHub specific
â”‚   â”œâ”€â”€ ğŸ“ workflows/                             # GitHub Actions
â”‚   â”‚   â”œâ”€â”€ ci.yml                                # Continuous integration
â”‚   â”‚   â”œâ”€â”€ cd.yml                                # Continuous deployment
â”‚   â”‚   â””â”€â”€ tests.yml                             # Run tests
â”‚   â””â”€â”€ ISSUE_TEMPLATE.md                         # Issue template
â”‚
â”œâ”€â”€ .gitignore                                    # Root git ignore
â”œâ”€â”€ .editorconfig                                 # Editor config
â”œâ”€â”€ .prettierrc                                   # Prettier config
â”œâ”€â”€ .eslintrc.js                                  # ESLint config
â”œâ”€â”€ docker-compose.yml                            # Docker setup (optional)
â”œâ”€â”€ LICENSE                                       # License file
â””â”€â”€ README.md                                     # Main project README
```
---
## System Architecture
### High-Level Architecture Diagram
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MULTI-TENANT ARCHITECTURE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   USERS     â”‚
                              â”‚ (Browsers)  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ HTTPS
                                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         CDN / Load Balancer (Vercel)               â”‚
        â”‚              - SSL Termination                     â”‚
        â”‚              - Static Asset Caching                â”‚
        â”‚              - DDoS Protection                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                               â”‚
     â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND      â”‚        â”‚   BACKEND API      â”‚
â”‚   React.js      â”‚ â—„â”€â”€â”€â”€â–º â”‚   Node.js/Express  â”‚
â”‚   (Vercel)      â”‚  API   â”‚   (Railway)        â”‚
â”‚                 â”‚ Calls  â”‚                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Components  â”‚ â”‚        â”‚ â”‚ Controllers    â”‚ â”‚
â”‚ â”‚ - Dashboard â”‚ â”‚        â”‚ â”‚ - Auth         â”‚ â”‚
â”‚ â”‚ - Portfoliosâ”‚ â”‚        â”‚ â”‚ - Portfolios   â”‚ â”‚
â”‚ â”‚ - Issues    â”‚ â”‚        â”‚ â”‚ - Issues       â”‚ â”‚
â”‚ â”‚ - Admin     â”‚ â”‚        â”‚ â”‚ - Analytics    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚        â”‚                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ State Mgmt  â”‚ â”‚        â”‚ â”‚ Middleware     â”‚ â”‚
â”‚ â”‚ - Auth      â”‚ â”‚        â”‚ â”‚ - Auth         â”‚ â”‚
â”‚ â”‚ - Tenant    â”‚ â”‚        â”‚ â”‚ - Tenant ISO   â”‚ â”‚â­
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â”‚ â”‚ - Validation   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚ - Rate Limit   â”‚ â”‚
                           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                           â”‚                    â”‚
                           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                           â”‚ â”‚ Services       â”‚ â”‚
                           â”‚ â”‚ - Business     â”‚ â”‚
                           â”‚ â”‚   Logic        â”‚ â”‚
                           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ SQL Queries
                                      â”‚ (with tenant_id)
                                      â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   SUPABASE (PostgreSQL)  â”‚
                        â”‚                          â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                        â”‚  â”‚ TENANTS TABLE      â”‚  â”‚
                        â”‚  â”‚ - tenant_id (PK)   â”‚  â”‚
                        â”‚  â”‚ - name             â”‚  â”‚
                        â”‚  â”‚ - subdomain        â”‚  â”‚
                        â”‚  â”‚ - status           â”‚  â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                        â”‚             â”‚            â”‚
                        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                        â”‚     â”‚                â”‚   â”‚
                        â”‚     â–¼                â–¼   â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”â”‚
                        â”‚  â”‚USERS â”‚       â”‚PORT- â”‚â”‚
                        â”‚  â”‚      â”‚       â”‚FOLIOSâ”‚â”‚
                        â”‚  â”‚tenantâ”‚       â”‚tenantâ”‚â”‚
                        â”‚  â”‚_id   â”‚       â”‚_id   â”‚â”‚
                        â”‚  â””â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”¬â”€â”€â”€â”˜â”‚
                        â”‚     â”‚              â”‚    â”‚
                        â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                        â”‚            â”‚            â”‚
                        â”‚            â–¼            â”‚
                        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”        â”‚
                        â”‚        â”‚ISSUES â”‚        â”‚
                        â”‚        â”‚tenant â”‚        â”‚â­
                        â”‚        â”‚_id    â”‚        â”‚
                        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                        â”‚                         â”‚
                        â”‚  âœ… Row Level Security  â”‚
                        â”‚  âœ… Automatic Backups   â”‚
                        â”‚  âœ… Real-time Sync      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â­ = tenant_id column (ensures data isolation)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               KEY SECURITY FEATURES                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. JWT Authentication (stateless tokens)                    â”‚
â”‚ 2. Tenant Isolation Middleware (auto-filters by tenant_id) â”‚
â”‚ 3. Row Level Security (database-level policies)            â”‚
â”‚ 4. HTTPS/SSL everywhere (encrypted communication)          â”‚
â”‚ 5. Rate Limiting (prevent abuse)                           â”‚
â”‚ 6. Input Validation (prevent SQL injection, XSS)           â”‚
â”‚ 7. CORS (restrict origins)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---
### Request Flow (Example: Logging an Issue)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 REQUEST FLOW: Log New Issue                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
USER (Browser)
    â”‚
    â”‚ 1. Clicks "Log Issue" button
    â”‚
    â”œâ”€â”€â–º FRONTEND (React)
    â”‚         â”‚
    â”‚         â”‚ 2. Opens IssueForm component
    â”‚         â”‚ 3. User fills form:
    â”‚         â”‚    - Portfolio: "Portfolio A"
    â”‚         â”‚    - Site: "Site 1"
    â”‚         â”‚    - Hour: 10
    â”‚         â”‚    - Description: "Inverter down"
    â”‚         â”‚    - Monitored By: "John Doe"
    â”‚         â”‚
    â”‚         â”‚ 4. User clicks "Submit"
    â”‚         â”‚
    â”‚         â”‚ 5. Frontend calls API:
    â”‚         â”‚    POST /api/issues
    â”‚         â”‚    Headers: {
    â”‚         â”‚      Authorization: "Bearer <JWT_TOKEN>"
    â”‚         â”‚    }
    â”‚         â”‚    Body: {
    â”‚         â”‚      portfolio_id: "uuid-123",
    â”‚         â”‚      site_name: "Site 1",
    â”‚         â”‚      issue_hour: 10,
    â”‚         â”‚      description: "Inverter down",
    â”‚         â”‚      monitored_by: "John Doe"
    â”‚         â”‚    }
    â”‚         â”‚
    â”‚         â–¼
    BACKEND (Node.js/Express)
         â”‚
         â”‚ 6. Middleware Chain:
         â”‚    a) auth.middleware.ts
         â”‚       â†“ Verify JWT token
         â”‚       â†“ Extract user_id & tenant_id from token
         â”‚       â†“ Attach to req: req.user, req.tenant_id
         â”‚    b) tenantIsolation.middleware.ts â­
         â”‚       â†“ Verify user belongs to tenant
         â”‚       â†“ Ensure portfolio_id belongs to tenant
         â”‚    c) validation.middleware.ts
         â”‚       â†“ Validate request body
         â”‚       â†“ Check required fields
         â”‚       â†“ Validate data types
         â”‚
         â”‚ 7. Routes to: issue.controller.ts
         â”‚    â†“ createIssue() function
         â”‚
         â”‚ 8. Calls: issue.service.ts
         â”‚    â†“ Business logic:
         â”‚    â†“ - Check for duplicate (same portfolio, same hour, same day)
         â”‚    â†“ - Verify portfolio exists
         â”‚    â†“ - Auto-add monitored_by to personnel list if new
         â”‚
         â”‚ 9. Prepares SQL query:
         â”‚    INSERT INTO issues (
         â”‚      tenant_id,           â† â­ Auto-added from req.tenant_id
         â”‚      portfolio_id,
         â”‚      site_name,
         â”‚      issue_hour,
         â”‚      description,
         â”‚      monitored_by,
         â”‚      created_at
         â”‚    ) VALUES (
         â”‚      'tenant-abc',        â† â­ User's tenant
         â”‚      'uuid-123',
         â”‚      'Site 1',
         â”‚      10,
         â”‚      'Inverter down',
         â”‚      'John Doe',
         â”‚      NOW()
         â”‚    )
         â”‚
         â–¼
    DATABASE (Supabase/PostgreSQL)
         â”‚
         â”‚ 10. Row Level Security (RLS) Policy:
         â”‚     â†“ Check: Does current_user have access to tenant-abc?
         â”‚     â†“ If YES: Allow INSERT
         â”‚     â†“ If NO: Reject with error
         â”‚
         â”‚ 11. Insert data into issues table
         â”‚
         â”‚ 12. Return inserted row with issue_id
         â”‚
         â–¼
    BACKEND (continues)
         â”‚
         â”‚ 13. issue.service.ts receives inserted data
         â”‚
         â”‚ 14. Log admin activity:
         â”‚     â†“ INSERT INTO admin_logs (
         â”‚     â†“   tenant_id: 'tenant-abc',
         â”‚     â†“   action_type: 'issue_logged',
         â”‚     â†“   action_description: 'Issue logged for Portfolio A'
         â”‚     â†“ )
         â”‚
         â”‚ 15. Release portfolio lock:
         â”‚     â†“ DELETE FROM hour_reservations
         â”‚     â†“ WHERE portfolio_id = 'uuid-123'
         â”‚     â†“   AND tenant_id = 'tenant-abc'
         â”‚     â†“   AND issue_hour = 10
         â”‚
         â”‚ 16. issue.controller.ts sends response:
         â”‚     â†“ HTTP 201 Created
         â”‚     â†“ Body: {
         â”‚     â†“   success: true,
         â”‚     â†“   data: {
         â”‚     â†“     issue_id: "issue-456",
         â”‚     â†“     message: "Issue logged successfully"
         â”‚     â†“   }
         â”‚     â†“ }
         â”‚
         â–¼
    FRONTEND (React)
         â”‚
         â”‚ 17. Receives success response
         â”‚
         â”‚ 18. Shows success notification:
         â”‚     â†“ Toast: "âœ… Issue logged successfully!"
         â”‚
         â”‚ 19. Closes IssueForm modal
         â”‚
         â”‚ 20. Refreshes data:
         â”‚     â†“ Fetch updated issues list
         â”‚     â†“ Update dashboard stats
         â”‚     â†“ Update heat maps
         â”‚
         â–¼
    USER (Browser)
         â”‚
         â”‚ 21. Sees updated UI with new issue
         â”‚
         âœ… COMPLETE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SECURITY CHECKPOINTS                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… JWT token verified (step 6a)                            â”‚
â”‚ âœ… User belongs to tenant verified (step 6b)               â”‚
â”‚ âœ… Portfolio belongs to tenant verified (step 6b)          â”‚
â”‚ âœ… Input validated (step 6c)                               â”‚
â”‚ âœ… Database RLS policy enforced (step 10)                  â”‚
â”‚ âœ… tenant_id auto-added to query (step 9)                  â”‚
â”‚ âœ… Cross-tenant access IMPOSSIBLE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---
## Database Design & ER Diagram
### Complete Database Schema
```sql
-- ============================================
-- MULTI-TENANT DATABASE SCHEMA
-- ============================================
-- ============================================
-- 1. TENANTS TABLE (Main tenant records)
-- ============================================
CREATE TABLE tenants (
    tenant_id       UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name            VARCHAR(255) NOT NULL UNIQUE,
    subdomain       VARCHAR(100) NOT NULL UNIQUE,
    logo_url        TEXT,
    contact_email   VARCHAR(255) NOT NULL,
    status          VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'inactive', 'suspended')),
    subscription_plan VARCHAR(50) DEFAULT 'basic' CHECK (subscription_plan IN ('basic', 'pro', 'enterprise')),
    settings        JSONB DEFAULT '{}',
    created_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
CREATE INDEX idx_tenants_subdomain ON tenants(subdomain);
CREATE INDEX idx_tenants_status ON tenants(status);
-- ============================================
-- 2. USERS TABLE (Authentication accounts)
-- ============================================
CREATE TABLE users (
    user_id         UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id       UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    username        VARCHAR(100) NOT NULL,
    password_hash   TEXT NOT NULL,
    full_name       VARCHAR(255),
    email           VARCHAR(255),
    role            VARCHAR(20) DEFAULT 'user' CHECK (role IN ('super_admin', 'tenant_admin', 'user')),
    is_active       BOOLEAN DEFAULT TRUE,
    last_login      TIMESTAMP WITH TIME ZONE,
    created_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(tenant_id, username)
);
CREATE INDEX idx_users_tenant_id ON users(tenant_id);
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
-- ============================================
-- 3. PORTFOLIOS TABLE (Portfolio/Project records)
-- ============================================
CREATE TABLE portfolios (
    portfolio_id             UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id                UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    name                     VARCHAR(255) NOT NULL,
    subtitle                 VARCHAR(100),
    site_range               VARCHAR(100),
    all_sites_checked        VARCHAR(10) CHECK (all_sites_checked IN ('Yes', 'No', 'Pending')),
    all_sites_checked_hour   INTEGER CHECK (all_sites_checked_hour >= 0 AND all_sites_checked_hour <= 23),
    all_sites_checked_date   DATE,
    all_sites_checked_by     VARCHAR(255),
    sites_checked_details    TEXT,
    is_locked                BOOLEAN DEFAULT FALSE,
    locked_by                VARCHAR(255),
    locked_at                TIMESTAMP WITH TIME ZONE,
    created_at               TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at               TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(tenant_id, name)
);
CREATE INDEX idx_portfolios_tenant_id ON portfolios(tenant_id);
CREATE INDEX idx_portfolios_name ON portfolios(name);
CREATE INDEX idx_portfolios_status ON portfolios(all_sites_checked);
-- ============================================
-- 4. ISSUES TABLE (Issue/Ticket records)
-- ============================================
CREATE TABLE issues (
    issue_id        UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id       UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    portfolio_id    UUID NOT NULL REFERENCES portfolios(portfolio_id) ON DELETE CASCADE,
    site_name       VARCHAR(255),
    issue_hour      INTEGER NOT NULL CHECK (issue_hour >= 0 AND issue_hour <= 23),
    description     TEXT NOT NULL,
    issue_type      VARCHAR(100),
    severity        VARCHAR(20) CHECK (severity IN ('low', 'medium', 'high', 'critical')),
    status          VARCHAR(20) DEFAULT 'open' CHECK (status IN ('open', 'in_progress', 'resolved', 'closed')),
    monitored_by    VARCHAR(255),
    missed_by       TEXT[],
    attachments     JSONB DEFAULT '[]',
    notes           TEXT,
    resolved_at     TIMESTAMP WITH TIME ZONE,
    resolved_by     VARCHAR(255),
    created_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by      UUID REFERENCES users(user_id)
);
CREATE INDEX idx_issues_tenant_id ON issues(tenant_id);
CREATE INDEX idx_issues_portfolio_id ON issues(portfolio_id);
CREATE INDEX idx_issues_created_at ON issues(created_at);
CREATE INDEX idx_issues_issue_hour ON issues(issue_hour);
CREATE INDEX idx_issues_status ON issues(status);
CREATE INDEX idx_issues_monitored_by ON issues(monitored_by);
-- ============================================
-- 5. HOUR_RESERVATIONS TABLE (Portfolio locking)
-- ============================================
CREATE TABLE hour_reservations (
    id              UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id       UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    portfolio_id    UUID NOT NULL REFERENCES portfolios(portfolio_id) ON DELETE CASCADE,
    issue_hour      INTEGER NOT NULL CHECK (issue_hour >= 0 AND issue_hour <= 23),
    monitored_by    VARCHAR(255) NOT NULL,
    session_id      VARCHAR(255) NOT NULL,
    reserved_at     TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    expires_at      TIMESTAMP WITH TIME ZONE NOT NULL,
    UNIQUE(tenant_id, portfolio_id, issue_hour)
);
CREATE INDEX idx_reservations_tenant_id ON hour_reservations(tenant_id);
CREATE INDEX idx_reservations_portfolio_id ON hour_reservations(portfolio_id);
CREATE INDEX idx_reservations_expires_at ON hour_reservations(expires_at);
-- ============================================
-- 6. ADMIN_LOGS TABLE (Audit trail)
-- ============================================
CREATE TABLE admin_logs (
    log_id                  UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id               UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    admin_name              VARCHAR(255) NOT NULL,
    action_type             VARCHAR(100) NOT NULL,
    action_description      TEXT NOT NULL,
    related_portfolio_id    UUID REFERENCES portfolios(portfolio_id) ON DELETE SET NULL,
    related_user_id         UUID REFERENCES users(user_id) ON DELETE SET NULL,
    metadata                JSONB DEFAULT '{}',
    created_at              TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
CREATE INDEX idx_admin_logs_tenant_id ON admin_logs(tenant_id);
CREATE INDEX idx_admin_logs_created_at ON admin_logs(created_at);
CREATE INDEX idx_admin_logs_action_type ON admin_logs(action_type);
-- ============================================
-- 7. MONITORED_PERSONNEL TABLE (Dropdown list)
-- ============================================
CREATE TABLE monitored_personnel (
    id              UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id       UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    name            VARCHAR(255) NOT NULL,
    role            VARCHAR(50) DEFAULT 'monitor',
    is_active       BOOLEAN DEFAULT TRUE,
    created_at      TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(tenant_id, name)
);
CREATE INDEX idx_monitored_personnel_tenant_id ON monitored_personnel(tenant_id);
CREATE INDEX idx_monitored_personnel_name ON monitored_personnel(name);
-- ============================================
-- 8. SUBSCRIPTIONS TABLE (Billing)
-- ============================================
CREATE TABLE subscriptions (
    subscription_id     UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id           UUID NOT NULL REFERENCES tenants(tenant_id) ON DELETE CASCADE,
    plan_name           VARCHAR(50) NOT NULL,
    status              VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'cancelled', 'expired', 'trial')),
    start_date          DATE NOT NULL,
    end_date            DATE,
    billing_cycle       VARCHAR(20) CHECK (billing_cycle IN ('monthly', 'yearly')),
    amount              DECIMAL(10, 2),
    currency            VARCHAR(3) DEFAULT 'USD',
    next_billing_date   DATE,
    created_at          TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at          TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
CREATE INDEX idx_subscriptions_tenant_id ON subscriptions(tenant_id);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
-- ============================================
-- ROW LEVEL SECURITY (RLS) POLICIES
-- ============================================
-- Enable RLS on all tables
ALTER TABLE tenants ENABLE ROW LEVEL SECURITY;
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE portfolios ENABLE ROW LEVEL SECURITY;
ALTER TABLE issues ENABLE ROW LEVEL SECURITY;
ALTER TABLE hour_reservations ENABLE ROW LEVEL SECURITY;
ALTER TABLE admin_logs ENABLE ROW LEVEL SECURITY;
ALTER TABLE monitored_personnel ENABLE ROW LEVEL SECURITY;
ALTER TABLE subscriptions ENABLE ROW LEVEL SECURITY;
-- Policy: Users can only access their own tenant's data
CREATE POLICY tenant_isolation_policy_users
ON users
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_portfolios
ON portfolios
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_issues
ON issues
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_reservations
ON hour_reservations
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_admin_logs
ON admin_logs
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_monitored_personnel
ON monitored_personnel
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
CREATE POLICY tenant_isolation_policy_subscriptions
ON subscriptions
FOR ALL
USING (tenant_id = current_setting('app.current_tenant_id')::UUID);
-- Super admin bypass (can access all tenants)
CREATE POLICY super_admin_access_tenants
ON tenants
FOR ALL
USING (current_setting('app.user_role') = 'super_admin');
-- (Repeat for all tables as needed)
```
---
### Entity Relationship Diagram (ER Diagram)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATABASE ER DIAGRAM                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       TENANTS           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚ ğŸ”‘ tenant_id (PK)       â”‚                     â”‚
â”‚    name                 â”‚                     â”‚
â”‚    subdomain            â”‚                     â”‚
â”‚    logo_url             â”‚                     â”‚
â”‚    contact_email        â”‚                     â”‚
â”‚    status               â”‚                     â”‚
â”‚    subscription_plan    â”‚                     â”‚
â”‚    settings (JSON)      â”‚                     â”‚
â”‚    created_at           â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
            â”‚                                   â”‚
            â”‚ 1                                 â”‚
            â”‚                                   â”‚
            â”‚ *                                 â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
            â”‚                                â”‚  â”‚
            â–¼                                â–¼  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        USERS            â”‚      â”‚    SUBSCRIPTIONS     â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ ğŸ”‘ user_id (PK)         â”‚      â”‚ ğŸ”‘ subscription_id   â”‚
â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”˜
â”‚    username             â”‚  â”‚   â”‚    plan_name         â”‚
â”‚    password_hash        â”‚  â”‚   â”‚    status            â”‚
â”‚    full_name            â”‚  â”‚   â”‚    start_date        â”‚
â”‚    email                â”‚  â”‚   â”‚    end_date          â”‚
â”‚    role                 â”‚  â”‚   â”‚    billing_cycle     â”‚
â”‚    is_active            â”‚  â”‚   â”‚    amount            â”‚
â”‚    last_login           â”‚  â”‚   â”‚    currency          â”‚
â”‚    created_at           â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
            â”‚                â”‚
            â”‚ 1              â”‚
            â”‚                â”‚
            â”‚ *              â”‚
            â–¼                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     ADMIN_LOGS          â”‚  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚ ğŸ”‘ log_id (PK)          â”‚  â”‚
â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”— related_user_id (FK) â”¼â”€â”€â”˜
â”‚    admin_name           â”‚
â”‚    action_type          â”‚
â”‚    action_description   â”‚
â”‚    related_portfolio_id â”‚
â”‚    metadata (JSON)      â”‚
â”‚    created_at           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚      PORTFOLIOS         â”‚
            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
            â”‚ ğŸ”‘ portfolio_id (PK)    â”‚
            â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”
            â”‚    name                 â”‚     â”‚
            â”‚    subtitle             â”‚     â”‚
            â”‚    site_range           â”‚     â”‚
            â”‚    all_sites_checked    â”‚     â”‚
            â”‚    all_sites_checked_hr â”‚     â”‚
            â”‚    all_sites_checked_dt â”‚     â”‚
            â”‚    all_sites_checked_by â”‚     â”‚
            â”‚    sites_checked_detailsâ”‚     â”‚
            â”‚    is_locked            â”‚     â”‚
            â”‚    locked_by            â”‚     â”‚
            â”‚    locked_at            â”‚     â”‚
            â”‚    created_at           â”‚     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â”‚                   â”‚
                        â”‚ 1                 â”‚
                        â”‚                   â”‚
                        â”‚ *                 â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
            â”‚                      â”‚        â”‚
            â–¼                      â–¼        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ISSUES            â”‚   â”‚  HOUR_RESERVATIONS     â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ ğŸ”‘ issue_id (PK)        â”‚   â”‚ ğŸ”‘ id (PK)             â”‚
â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”˜
â”‚ ğŸ”— portfolio_id (FK) â”€â”€â”€â”˜   â”‚ ğŸ”— portfolio_id (FK) â”€â”€â”˜
â”‚ ğŸ”— created_by (FK)      â”‚   â”‚    issue_hour          â”‚
â”‚    site_name            â”‚   â”‚    monitored_by        â”‚
â”‚    issue_hour           â”‚   â”‚    session_id          â”‚
â”‚    description          â”‚   â”‚    reserved_at         â”‚
â”‚    issue_type           â”‚   â”‚    expires_at          â”‚
â”‚    severity             â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    status               â”‚
â”‚    monitored_by         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    missed_by (array)    â”‚   â”‚  MONITORED_PERSONNEL   â”‚
â”‚    attachments (JSON)   â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚    notes                â”‚   â”‚ ğŸ”‘ id (PK)             â”‚
â”‚    resolved_at          â”‚   â”‚ ğŸ”— tenant_id (FK) â”€â”€â”€â”€â”€â”¤
â”‚    resolved_by          â”‚   â”‚    name                â”‚
â”‚    created_at           â”‚   â”‚    role                â”‚
â”‚    updated_at           â”‚   â”‚    is_active           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    created_at          â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RELATIONSHIP SUMMARY                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. TENANTS â”€â”€<< 1:N >>â”€â”€ USERS                              â”‚
â”‚    One tenant has many users                                 â”‚
â”‚                                                              â”‚
â”‚ 2. TENANTS â”€â”€<< 1:N >>â”€â”€ PORTFOLIOS                         â”‚
â”‚    One tenant has many portfolios                            â”‚
â”‚                                                              â”‚
â”‚ 3. TENANTS â”€â”€<< 1:N >>â”€â”€ SUBSCRIPTIONS                      â”‚
â”‚    One tenant has many subscriptions                         â”‚
â”‚                                                              â”‚
â”‚ 4. PORTFOLIOS â”€â”€<< 1:N >>â”€â”€ ISSUES                          â”‚
â”‚    One portfolio has many issues                             â”‚
â”‚                                                              â”‚
â”‚ 5. PORTFOLIOS â”€â”€<< 1:N >>â”€â”€ HOUR_RESERVATIONS               â”‚
â”‚    One portfolio has many hour reservations (locks)          â”‚
â”‚                                                              â”‚
â”‚ 6. USERS â”€â”€<< 1:N >>â”€â”€ ISSUES                               â”‚
â”‚    One user creates many issues                              â”‚
â”‚                                                              â”‚
â”‚ 7. TENANTS â”€â”€<< 1:N >>â”€â”€ ADMIN_LOGS                         â”‚
â”‚    One tenant has many admin logs                            â”‚
â”‚                                                              â”‚
â”‚ 8. TENANTS â”€â”€<< 1:N >>â”€â”€ MONITORED_PERSONNEL                â”‚
â”‚    One tenant has many monitored personnel                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ”‘ = Primary Key (PK)
ğŸ”— = Foreign Key (FK)
```
---
### Data Flow & Tenant Isolation
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              HOW TENANT ISOLATION WORKS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Example: User from Tenant A tries to access data
Step 1: USER LOGS IN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User: john@clientA.com
Password: ********
    â†“
Backend verifies credentials
    â†“
Finds user record:
  - user_id: user-123
  - tenant_id: tenant-A
  - role: user
    â†“
Generate JWT token with payload:
{
  "user_id": "user-123",
  "tenant_id": "tenant-A",    â† â­ KEY FIELD
  "role": "user",
  "exp": 1234567890
}
    â†“
Return token to frontend
Step 2: USER MAKES API REQUEST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Frontend: GET /api/portfolios
Headers: {
  Authorization: "Bearer <JWT_TOKEN>"
}
    â†“
Backend receives request
    â†“
Auth Middleware extracts JWT:
  - Verifies signature âœ…
  - Decodes payload
  - Extracts tenant_id = "tenant-A"
  - Attaches to request: req.tenant_id = "tenant-A"
    â†“
Tenant Isolation Middleware:
  - Ensures req.tenant_id exists
  - Will auto-filter all queries
    â†“
Route handler: portfolio.controller.ts
  - Calls portfolio.service.ts
    â†“
Service builds SQL query:
  SELECT * FROM portfolios
  WHERE tenant_id = 'tenant-A'    â† â­ AUTO-ADDED
  ORDER BY name
    â†“
Database executes query
    â†“
Returns ONLY portfolios for Tenant A
    â†“
Response sent to frontend
Step 3: ATTEMPT TO ACCESS OTHER TENANT'S DATA (Attack)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Malicious request: GET /api/portfolios?tenant_id=tenant-B
Headers: {
  Authorization: "Bearer <JWT_TOKEN>"  â† Token has tenant-A
}
    â†“
Backend receives request
    â†“
Auth Middleware:
  - Extracts tenant_id from TOKEN = "tenant-A"
  - Ignores URL parameter (not trusted!)
  - Sets req.tenant_id = "tenant-A"
    â†“
Service builds query:
  SELECT * FROM portfolios
  WHERE tenant_id = 'tenant-A'    â† Uses token's tenant_id, NOT URL param
  ORDER BY name
    â†“
Still returns ONLY Tenant A's portfolios
    â†“
Attack prevented! âœ…
Step 4: DATABASE-LEVEL PROTECTION (RLS)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Even if backend is compromised:
    â†“
Backend (compromised) tries:
  SELECT * FROM portfolios
  -- (no WHERE clause!)
    â†“
PostgreSQL Row Level Security (RLS) kicks in:
  - Checks current_setting('app.current_tenant_id')
  - If not set or doesn't match: REJECT query
  - Only returns rows where tenant_id matches session tenant
    â†“
Database-level protection âœ…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MULTI-LAYER SECURITY GUARANTEES                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 1: JWT Token contains tenant_id                       â”‚
â”‚ Layer 2: Backend middleware enforces tenant_id              â”‚
â”‚ Layer 3: All queries auto-filter by tenant_id               â”‚
â”‚ Layer 4: Database RLS policies enforce at DB level          â”‚
â”‚ Layer 5: No cross-tenant foreign keys possible              â”‚
â”‚                                                              â”‚
â”‚ Result: 100% DATA ISOLATION GUARANTEED                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---
## Technology Stack Details
### Frontend Stack
| Technology | Version | Purpose | Documentation |
|------------|---------|---------|---------------|
| **React** | 18.x | UI Library | https://react.dev |
| **TypeScript** | 5.x | Type Safety | https://typescriptlang.org |
| **React Router** | 6.x | Client-side Routing | https://reactrouter.com |
| **Tailwind CSS** | 3.x | Styling | https://tailwindcss.com |
| **Axios** | 1.x | HTTP Client | https://axios-http.com |
| **React Query** | 4.x | Data Fetching & Caching | https://tanstack.com/query |
| **Zustand** | 4.x | State Management | https://zustand-demo.pmnd.rs |
| **React Hook Form** | 7.x | Form Management | https://react-hook-form.com |
| **Chart.js** | 4.x | Charts & Graphs | https://www.chartjs.org |
| **date-fns** | 2.x | Date Utilities | https://date-fns.org |
| **React Hot Toast** | 2.x | Notifications | https://react-hot-toast.com |
### Backend Stack
| Technology | Version | Purpose | Documentation |
|------------|---------|---------|---------------|
| **Node.js** | 18.x | Runtime | https://nodejs.org |
| **Express** | 4.x | Web Framework | https://expressjs.com |
| **TypeScript** | 5.x | Type Safety | https://typescriptlang.org |
| **Supabase Client** | 2.x | Database Client | https://supabase.com/docs |
| **bcrypt** | 5.x | Password Hashing | https://www.npmjs.com/package/bcrypt |
| **jsonwebtoken** | 9.x | JWT Auth | https://jwt.io |
| **express-validator** | 7.x | Input Validation | https://express-validator.github.io |
| **express-rate-limit** | 6.x | Rate Limiting | https://www.npmjs.com/package/express-rate-limit |
| **winston** | 3.x | Logging | https://github.com/winstonjs/winston |
| **cors** | 2.x | CORS Handling | https://www.npmjs.com/package/cors |
| **dotenv** | 16.x | Environment Variables | https://www.npmjs.com/package/dotenv |
| **nodemon** | 3.x | Dev Server | https://nodemon.io |
### Database
| Technology | Purpose | Documentation |
|------------|---------|---------------|
| **PostgreSQL** | Relational Database | https://postgresql.org |
| **Supabase** | Database Platform | https://supabase.com/docs |
### DevOps & Deployment
| Tool | Purpose | Free Tier | Documentation |
|------|---------|-----------|---------------|
| **Vercel** | Frontend Hosting | âœ… Yes | https://vercel.com/docs |
| **Railway** | Backend Hosting | âœ… $5 credit/mo | https://docs.railway.app |
| **Supabase** | Database Hosting | âœ… 500MB | https://supabase.com/docs |
| **GitHub** | Version Control | âœ… Unlimited | https://docs.github.com |
| **GitHub Actions** | CI/CD | âœ… 2000 min/mo | https://docs.github.com/actions |
---
## API Endpoints Documentation
### Authentication Endpoints
```
POST   /api/auth/register           # Register new user
POST   /api/auth/login              # User login
POST   /api/auth/logout             # User logout
POST   /api/auth/refresh            # Refresh JWT token
POST   /api/auth/forgot-password    # Request password reset
POST   /api/auth/reset-password     # Reset password
GET    /api/auth/me                 # Get current user info
```
### Tenant Endpoints (Super Admin Only)
```
GET    /api/tenants                 # List all tenants
POST   /api/tenants                 # Create new tenant
GET    /api/tenants/:id             # Get tenant details
PUT    /api/tenants/:id             # Update tenant
DELETE /api/tenants/:id             # Delete tenant
GET    /api/tenants/:id/stats       # Get tenant statistics
```
### User Endpoints
```
GET    /api/users                   # List users (filtered by tenant)
POST   /api/users                   # Create new user
GET    /api/users/:id               # Get user details
PUT    /api/users/:id               # Update user
DELETE /api/users/:id               # Delete user
PUT    /api/users/:id/activate      # Activate user
PUT    /api/users/:id/deactivate    # Deactivate user
```
### Portfolio Endpoints
```
GET    /api/portfolios              # List portfolios (filtered by tenant)
POST   /api/portfolios              # Create new portfolio
GET    /api/portfolios/:id          # Get portfolio details
PUT    /api/portfolios/:id          # Update portfolio
DELETE /api/portfolios/:id          # Delete portfolio
PUT    /api/portfolios/:id/status   # Update "all sites checked" status
POST   /api/portfolios/:id/lock     # Lock portfolio (reserve hour)
DELETE /api/portfolios/:id/unlock   # Unlock portfolio
```
### Issue Endpoints
```
GET    /api/issues                  # List issues (filtered by tenant)
POST   /api/issues                  # Create new issue
GET    /api/issues/:id              # Get issue details
PUT    /api/issues/:id              # Update issue
DELETE /api/issues/:id              # Delete issue
PUT    /api/issues/:id/resolve      # Mark issue as resolved
GET    /api/issues/export           # Export issues to Excel/CSV
```
### Analytics Endpoints
```
GET    /api/analytics/dashboard     # Dashboard statistics
GET    /api/analytics/coverage      # Hourly coverage data
GET    /api/analytics/performance   # Performance metrics
GET    /api/analytics/users         # Issues by user report
GET    /api/analytics/matrix        # Portfolio monitoring matrix
GET    /api/analytics/trends        # Trend analysis
```
### Admin Endpoints
```
GET    /api/admin/logs              # Admin activity logs
POST   /api/admin/logs              # Add custom log entry
GET    /api/admin/locks             # Active portfolio locks
DELETE /api/admin/locks/:id         # Unlock portfolio (admin override)
GET    /api/admin/personnel         # Monitored personnel list
POST   /api/admin/personnel         # Add monitored person
DELETE /api/admin/personnel/:id     # Delete monitored person
```
### Super Admin Endpoints
```
GET    /api/super-admin/dashboard   # Global analytics
GET    /api/super-admin/tenants     # All tenants
GET    /api/super-admin/users       # All users (cross-tenant)
GET    /api/super-admin/system      # System health metrics
POST   /api/super-admin/impersonate/:tenantId  # Login as tenant
```
---
## Authentication Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  AUTHENTICATION FLOW                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
REGISTRATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User â†’ Frontend: Fill registration form
Frontend â†’ Backend: POST /api/auth/register
Backend:
  1. Validate input
  2. Check if username/email exists
  3. Hash password (bcrypt)
  4. Create user record with tenant_id
  5. Return success message
Frontend: Show success, redirect to login
LOGIN:
â”€â”€â”€â”€â”€â”€
User â†’ Frontend: Enter username/password
Frontend â†’ Backend: POST /api/auth/login
Backend:
  1. Find user by username
  2. Verify password (bcrypt.compare)
  3. Check user is_active = true
  4. Generate JWT token:
     {
       "user_id": "uuid-123",
       "tenant_id": "tenant-abc",
       "role": "user",
       "exp": Date.now() + 8h
     }
  5. Update last_login timestamp
  6. Return JWT token
Frontend:
  1. Store token in localStorage/sessionStorage
  2. Set Authorization header for future requests
  3. Redirect to dashboard
AUTHENTICATED REQUEST:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Frontend â†’ Backend: GET /api/portfolios
Headers: {
  Authorization: "Bearer <JWT_TOKEN>"
}
Backend (auth.middleware.ts):
  1. Extract token from header
  2. Verify JWT signature
  3. Check token not expired
  4. Decode payload
  5. Extract user_id & tenant_id
  6. Attach to request:
     req.user = { user_id, tenant_id, role }
  7. Continue to route handler
Route Handler:
  1. Access req.user.tenant_id
  2. Filter data by tenant_id
  3. Return filtered results
LOGOUT:
â”€â”€â”€â”€â”€â”€â”€
User â†’ Frontend: Click logout
Frontend:
  1. Call POST /api/auth/logout (optional)
  2. Remove token from storage
  3. Clear auth state
  4. Redirect to login
```
---
## Data Flow Diagrams
### Dashboard Data Flow
```
User opens Dashboard page
    â†“
Frontend: Dashboard.tsx
    â†“
useEffect() hook triggers
    â†“
Calls: fetchDashboardData()
    â†“
    â”œâ”€â–º GET /api/analytics/dashboard
    â”‚     â†“
    â”‚   Backend: analytics.controller.ts
    â”‚     â†“
    â”‚   Queries (all filtered by tenant_id):
    â”‚     - COUNT(*) FROM issues WHERE tenant_id = X
    â”‚     - COUNT(DISTINCT portfolio_id) FROM issues WHERE tenant_id = X
    â”‚     - AVG(issue_hour) FROM issues WHERE tenant_id = X
    â”‚     â†“
    â”‚   Returns: { total_issues, portfolios_with_issues, avg_issue_hour }
    â”‚
    â”œâ”€â–º GET /api/analytics/coverage
    â”‚     â†“
    â”‚   Backend: analytics.controller.ts
    â”‚     â†“
    â”‚   Query:
    â”‚     SELECT issue_hour, COUNT(*) as count
    â”‚     FROM issues
    â”‚     WHERE tenant_id = X
    â”‚       AND DATE(created_at) = CURRENT_DATE
    â”‚     GROUP BY issue_hour
    â”‚     â†“
    â”‚   Returns: { coverage_by_hour: [{hour: 0, count: 5}, ...] }
    â”‚
    â””â”€â–º GET /api/admin/logs?limit=5
          â†“
        Backend: admin.controller.ts
          â†“
        Query:
          SELECT * FROM admin_logs
          WHERE tenant_id = X
          ORDER BY created_at DESC
          LIMIT 5
          â†“
        Returns: [{ log_id, action_type, description, ... }]
    â†“
Frontend receives all data
    â†“
Update state (useState):
  - setStats(statsData)
  - setCoverage(coverageData)
  - setLogs(logsData)
    â†“
React re-renders Dashboard
    â†“
Display:
  - Stats Cards (with counts)
  - Heat Maps (with coverage data)
  - Admin Log Widget (with recent logs)
    â†“
Set up auto-refresh timer (every 30 seconds)
```
---
## File Size Estimates
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROJECT SIZE ESTIMATES                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Frontend (React + TypeScript):                               â”‚
â”‚   - Source code: ~500 files, ~50,000 lines, ~5 MB           â”‚
â”‚   - node_modules: ~200 MB                                    â”‚
â”‚   - Build output: ~2-5 MB (gzipped: ~500 KB)               â”‚
â”‚                                                              â”‚
â”‚ Backend (Node.js + TypeScript):                              â”‚
â”‚   - Source code: ~200 files, ~20,000 lines, ~2 MB           â”‚
â”‚   - node_modules: ~100 MB                                    â”‚
â”‚                                                              â”‚
â”‚ Database:                                                    â”‚
â”‚   - Schema: ~10 KB                                           â”‚
â”‚   - Data (10,000 issues): ~50 MB                            â”‚
â”‚                                                              â”‚
â”‚ Total Development Size: ~360 MB                              â”‚
â”‚ Total Production Size: ~7 MB (frontend) + ~102 MB (backend) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---
## Development Timeline
```
Week 1-2: Foundation
â”œâ”€â”€ Setup project structure
â”œâ”€â”€ Configure Supabase
â”œâ”€â”€ Create database schema
â”œâ”€â”€ Setup authentication
â””â”€â”€ Build basic UI components
Week 3: Tenant Management
â”œâ”€â”€ Tenant CRUD operations
â”œâ”€â”€ Tenant isolation middleware
â”œâ”€â”€ Data filtering by tenant_id
â””â”€â”€ Test tenant isolation
Week 4-5: Core Features
â”œâ”€â”€ Port all features from current app
â”œâ”€â”€ Portfolio management
â”œâ”€â”€ Issue tracking
â”œâ”€â”€ Hourly coverage
â”œâ”€â”€ Admin panel
â””â”€â”€ Analytics
Week 6: Polish & Deploy
â”œâ”€â”€ Testing (unit, integration, E2E)
â”œâ”€â”€ Security audit
â”œâ”€â”€ Performance optimization
â”œâ”€â”€ Deploy to production (Vercel + Railway)
â””â”€â”€ Documentation
Total: 6 weeks for MVP
```
---
**Document Version:** 1.0  
**Last Updated:** December 17, 2025  
**Status:** Ready for Development
---
**End of Document**